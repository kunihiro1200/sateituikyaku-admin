# Implementation Plan

- [x] 1. バックエンド: BuyerLinkageServiceの実装




  - BuyerLinkageServiceクラスを作成
  - 物件番号から買主カウントを取得するメソッドを実装
  - 物件番号から買主リストを取得するメソッドを実装
  - 複数物件の買主カウントをバッチ取得するメソッドを実装
  - 高確度買主を持つ物件リストを取得するメソッドを実装
  - _Requirements: 1.1, 1.2, 1.4, 2.1, 2.2, 5.1, 5.2, 6.2_





- [ ] 2. バックエンド: キャッシング機能の実装
  - BuyerLinkageCacheクラスを作成
  - 買主カウントのキャッシュ取得/設定メソッドを実装
  - 買主リストのキャッシュ取得/設定メソッドを実装
  - キャッシュ無効化メソッドを実装




  - TTLを5分に設定
  - _Requirements: 5.3_

- [ ] 3. バックエンド: APIルートの実装
  - GET /api/property-listings/buyer-counts エンドポイントを実装
  - GET /api/property-listings/:propertyNumber/buyers エンドポイントを実装




  - GET /api/property-listings/high-confidence-buyers エンドポイントを実装
  - クエリパラメータのバリデーションを実装
  - エラーハンドリングを実装
  - _Requirements: 1.1, 2.1, 2.2, 5.1, 5.2, 6.2_

- [x] 4. フロントエンド: BuyerIndicatorコンポーネントの実装




  - BuyerIndicator.tsxコンポーネントを作成
  - 買主カウントをChipで表示
  - 高確度買主がいる場合は赤色で表示
  - クリックで買主リスト展開/折りたたみ機能を実装
  - Popoverで買主リストを表示
  - _Requirements: 1.1, 1.2, 2.1, 2.4, 4.1, 4.2_

- [ ] 5. フロントエンド: BuyerListコンポーネントの実装
  - BuyerList.tsxコンポーネントを作成



  - 買主の基本情報（買主番号、氏名、電話番号、メール、ステータス、確度）を表示
  - 受付日でソート（降順）
  - 高確度買主を左ボーダーでハイライト
  - 電話番号をtel:リンクとして表示
  - メールアドレスをmailto:リンクとして表示


  - 買主クリックで買主詳細ページへ遷移
  - ローディング状態と空状態の表示
  - _Requirements: 2.2, 2.3, 3.1, 3.2, 4.1, 4.2, 4.3, 4.4, 7.1, 7.2, 7.3, 7.4, 8.1, 8.2, 8.3_

- [x] 6. フロントエンド: PropertyListingsPageの更新


  - 買主カウント取得APIを呼び出す


  - ページネーション時に表示中の物件のみ買主カウントを取得
  - 各物件行にBuyerIndicatorコンポーネントを追加
  - 買主カウントの状態管理を実装
  - _Requirements: 1.1, 1.2, 5.4_

- [ ] 7. フロントエンド: フィルタリング機能の実装
  - 「買主あり」フィルターを追加
  - 「高確度買主あり」フィルターを追加
  - フィルター適用時に物件リストを更新
  - サイドバーにフィルターUIを追加
  - _Requirements: 6.1, 6.2, 6.3_

- [ ] 8. Checkpoint - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、問題があればユーザーに質問する

- [ ] 9. 統合テストとマニュアルテスト
  - 物件リストページで買主インジケーターの表示を確認
  - 買主リストの展開/折りたたみ動作を確認
  - 高確度買主のハイライト表示を確認
  - 買主詳細ページへの遷移を確認
  - フィルタリング機能の動作を確認
  - パフォーマンステスト（大量データでの動作確認）
  - _Requirements: All_
