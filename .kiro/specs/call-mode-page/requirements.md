# 要件定義書

## はじめに

営業担当者が売主に電話をかける際に、物件情報や売主情報を見ながら通話メモを記録できる専用ページを作成します。画面を左右2分割し、左側に参照情報、右側に通話メモ入力欄を配置することで、効率的な追客活動を支援します。

## 用語集

- **System**: 売主リスト管理システム
- **Call Mode Page**: 通話専用ページ（/sellers/:id/call）
- **Employee**: システムを利用する営業担当者
- **Seller**: 売主
- **Property**: 物件
- **Call Memo**: 通話メモ
- **Quick Phrase**: よく使うフレーズ（定型文）

## 要件

### 要件 1

**ユーザーストーリー:** 営業担当者として、売主に電話をかける時に、物件情報と売主情報を見ながら通話メモを記録したい。そうすることで、スムーズに会話を進め、重要な情報を漏らさずに記録できる。

#### 受入基準

1. WHEN 売主詳細ページで「通話メモ」ボタンをクリックする THEN THE System SHALL 通話専用ページ（/sellers/:id/call）に遷移する
2. WHEN 通話専用ページが表示される THEN THE System SHALL 画面を左右2分割して表示する
3. WHEN 画面が表示される THEN THE System SHALL 左側に物件情報、売主情報、査定情報を表示する
4. WHEN 画面が表示される THEN THE System SHALL 右側に通話メモ入力欄を表示する
5. WHEN ユーザーが通話を終了する THEN THE System SHALL 売主詳細ページに戻る

### 要件 2

**ユーザーストーリー:** 営業担当者として、電話中に物件情報を最初に確認したい。そうすることで、物件の詳細を把握してから会話を始められる。

#### 受入基準

1. WHEN 左側の情報表示エリアが表示される THEN THE System SHALL 最上部に物件情報を配置する
2. WHEN 物件情報が表示される THEN THE System SHALL 物件住所、物件種別、土地面積、建物面積、築年を含める
3. WHEN 物件情報の下に売主情報を表示する THEN THE System SHALL 氏名、住所、電話番号、メールアドレスを含める
4. WHEN 売主情報の下に査定情報を表示する THEN THE System SHALL 最新の査定額、価格範囲、査定日時を含める
5. WHEN 査定情報の下に過去の追客履歴を表示する THEN THE System SHALL 最終通話日とAI要約を含める

### 要件 3

**ユーザーストーリー:** 営業担当者として、通話メモを素早く入力したい。そうすることで、電話中でも効率的にメモを取れる。

#### 受入基準

1. WHEN 右側の通話メモ入力エリアが表示される THEN THE System SHALL よく使うフレーズボタンを表示する
2. WHEN よく使うフレーズボタンをクリックする THEN THE System SHALL そのフレーズを入力欄に追加する
3. WHEN 通話メモ入力欄が表示される THEN THE System SHALL 複数行のテキストエリアを提供する
4. WHEN 通話メモ入力欄の下に過去の通話履歴を表示する THEN THE System SHALL 最新5件の通話メモを「担当者イニシャル 日時」形式で表示する
5. WHEN ユーザーが「保存して終了」ボタンをクリックする THEN THE System SHALL 通話メモを保存し、売主詳細ページに戻る

### 要件 4

**ユーザーストーリー:** 営業担当者として、画面レイアウトが固定されていて欲しい。そうすることで、毎回同じ場所に情報があり、素早く確認できる。

#### 受入基準

1. WHEN 通話専用ページが表示される THEN THE System SHALL 左側を画面幅の50%に固定する
2. WHEN 通話専用ページが表示される THEN THE System SHALL 右側を画面幅の50%に固定する
3. WHEN 左側の情報表示エリアが表示される THEN THE System SHALL スクロール可能にする
4. WHEN 右側の通話メモ入力エリアが表示される THEN THE System SHALL 入力欄と過去の履歴をスクロール可能にする
5. WHEN ページ全体が表示される THEN THE System SHALL ヘッダーとフッターを最小限にし、情報表示エリアを最大化する

### 要件 5

**ユーザーストーリー:** 営業担当者として、通話中に必要な情報だけを表示したい。そうすることで、画面が煩雑にならず、集中して電話できる。

#### 受入基準

1. WHEN 通話専用ページが表示される THEN THE System SHALL 査定実行ボタンや予約作成ボタンなどの操作ボタンを表示しない
2. WHEN 通話専用ページが表示される THEN THE System SHALL 編集機能を提供しない
3. WHEN 通話専用ページが表示される THEN THE System SHALL 読み取り専用の情報表示に徹する
4. WHEN 通話専用ページが表示される THEN THE System SHALL 通話メモの入力と保存のみを操作可能にする
5. WHEN ユーザーが戻るボタンをクリックする THEN THE System SHALL 入力中の通話メモを破棄せずに確認ダイアログを表示する

### 要件 6

**ユーザーストーリー:** 営業担当者として、過去の通話履歴をすぐに確認したい。そうすることで、前回の会話内容を思い出してから電話できる。

#### 受入基準

1. WHEN 右側の通話メモ入力エリアに過去の通話履歴が表示される THEN THE System SHALL 各通話メモに担当者イニシャルと日時を表示する
2. WHEN 過去の通話履歴が表示される THEN THE System SHALL 最新5件のみを表示する
3. WHEN 過去の通話履歴が表示される THEN THE System SHALL 新しい順に並べる
4. WHEN 過去の通話履歴が表示される THEN THE System SHALL 各メモの内容を省略せずに全文表示する
5. WHEN 過去の通話履歴エリアがスクロール可能である THEN THE System SHALL 5件以上ある場合にスクロールバーを表示する

### 要件 7

**ユーザーストーリー:** 営業担当者として、通話中に売主情報を編集したい。そうすることで、電話で確認した最新の情報をすぐに更新できる。

#### 受入基準

1. WHEN 売主情報セクションに編集ボタンが表示される THEN THE System SHALL ボタンをクリックすると編集モードに切り替わる
2. WHEN 編集モードに切り替わる THEN THE System SHALL 氏名、住所、電話番号、メールアドレスの入力フィールドを表示する
3. WHEN 編集モードで入力フィールドが表示される THEN THE System SHALL 現在の値を初期値として設定する
4. WHEN ユーザーが保存ボタンをクリックする THEN THE System SHALL 入力された情報を検証し、データベースに保存する
5. WHEN 保存が成功する THEN THE System SHALL 編集モードを終了し、更新された情報を表示する
6. WHEN ユーザーがキャンセルボタンをクリックする THEN THE System SHALL 編集内容を破棄し、元の表示モードに戻る
7. WHEN 保存が失敗する THEN THE System SHALL エラーメッセージを表示し、編集モードを維持する
