# 実装計画

- [ ] 1. ActivityLogTableコンポーネントの作成
  - 新しいコンポーネント `frontend/src/components/ActivityLogTable.tsx` を作成
  - データ取得ロジックを実装（既存の `/sellers/:id/activities` APIを使用）
  - テーブル表示ロジックを実装（日時、担当者、種別、内容）
  - 種別アイコンの表示ロジックを実装
  - 担当者表示名の生成ロジックを実装（`getDisplayName` ユーティリティを使用）
  - ローディング状態とエラー状態の表示を実装
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 2.1, 2.2, 2.3, 2.4, 2.5, 3.1, 3.2, 3.3, 3.4_

- [ ] 2. SQL構文エラーの調査と修正
  - 既存の `backend/src/services/ActivityLogService.ts` を確認
  - SQLクエリの構文エラーを特定
  - 予約語（`type`, `date`, `order`）を適切にエスケープ
  - JOIN句の構文を確認・修正
  - SQLクエリのテストを実行
  - _要件: 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ]* 2.1 SQL構文修正のプロパティテストを作成
  - **Property 5: SQL構文の正確性**
  - **検証: 要件 5.1, 5.2, 5.3, 5.4, 5.5**
  - ランダムな売主IDに対して、SQLクエリが正しく実行されることを確認
  - 構文エラーが発生しないことを確認

- [ ] 3. CallModePageの更新
  - `frontend/src/pages/CallModePage.tsx` を開く
  - `ActivityLogTable` コンポーネントをインポート
  - 適切な位置に `ActivityLogTable` を配置（`FollowUpLogHistoryTable` の上）
  - レイアウトを調整
  - _要件: 1.1_

- [ ] 4. スタイリングとレスポンシブデザイン
  - テーブルのスタイリングを実装
  - スクロール可能なテーブルを実装
  - ヘッダー行を固定
  - レスポンシブデザインを適用
  - _要件: 6.1, 6.2, 6.3, 6.4, 6.5, 7.1, 7.2, 7.3, 7.4, 7.5_

- [ ]* 5. ユニットテストの作成
  - `ActivityLogTable` コンポーネントのユニットテストを作成
  - データ取得ロジックのテストを作成
  - テーブル表示ロジックのテストを作成
  - 種別アイコン表示のテストを作成
  - 担当者表示名生成のテストを作成
  - エラーハンドリングのテストを作成

- [ ]* 5.1 データ取得の正確性プロパティテストを作成
  - **Property 1: データ取得の正確性**
  - **検証: 要件 1.1, 4.1**
  - ランダムな売主IDに対して、該当する追客ログのみが返されることを確認

- [ ]* 5.2 ソート順の一貫性プロパティテストを作成
  - **Property 2: ソート順の一貫性**
  - **検証: 要件 1.3, 4.3**
  - ランダムな追客ログリストに対して、最新のログが上位に表示されることを確認

- [ ]* 5.3 表示件数の制限プロパティテストを作成
  - **Property 3: 表示件数の制限**
  - **検証: 要件 1.4, 4.4**
  - ランダムな売主に対して、最大20件のログのみが表示されることを確認

- [ ]* 5.4 担当者表示の一貫性プロパティテストを作成
  - **Property 4: 担当者表示の一貫性**
  - **検証: 要件 3.2, 3.4**
  - ランダムなメールアドレスに対して、同じ表示名が生成されることを確認

- [ ]* 5.5 種別アイコンの一貫性プロパティテストを作成
  - **Property 6: 種別アイコンの一貫性**
  - **検証: 要件 2.1, 2.2, 2.3, 2.4, 2.5**
  - ランダムな追客ログの種別に対して、対応するアイコンが表示されることを確認

- [ ]* 5.6 空データの処理プロパティテストを作成
  - **Property 7: 空データの処理**
  - **検証: 要件 1.5**
  - 追客ログが存在しない売主に対して、適切なメッセージが表示されることを確認

- [ ] 6. 動作確認とデバッグ
  - 通話モードページを開いて動作確認
  - 追客ログテーブルが正しく表示されることを確認
  - SQL構文エラーが発生しないことを確認
  - データが正しく表示されることを確認
  - エラーハンドリングが正しく動作することを確認
  - _要件: すべて_

- [ ] 7. 最終チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認
  - ユーザーに質問があれば確認
