# 実装計画

- [x] 1. バックエンド型定義の拡張


  - `ActivityWithEmployee` インターフェースを `backend/src/types/index.ts` に追加
  - `Activity` インターフェースに `employee` フィールドを追加（オプショナル）
  - _要件: 4.1, 4.2_



- [ ] 2. FollowUpService の getActivityHistory メソッドを更新
  - `activities` と `employees` テーブルを LEFT JOIN するクエリに変更
  - 担当者情報（id、email、name）を含むレスポンスを返す
  - スネークケースからキャメルケースへの変換を実装
  - _要件: 3.1, 3.2, 4.1, 4.2, 4.3_

- [ ]* 2.1 FollowUpService のユニットテストを作成
  - 担当者情報が正しく JOIN されることをテスト
  - 担当者が見つからない場合、employee が null になることをテスト
  - 複数の活動ログが正しい順序で返されることをテスト
  - _要件: 3.2, 4.1, 4.2_

- [ ]* 2.2 Property 1 のプロパティベーステストを作成
  - **Property 1: 活動ログには担当者情報が含まれる**
  - **検証: 要件 1.1, 3.2, 4.1, 4.2**

- [ ]* 2.3 Property 5 のプロパティベーステストを作成
  - **Property 5: API レスポンスはキャメルケースである**
  - **検証: 要件 4.3**

- [x]* 2.4 Property 6 のプロパティベーステストを作成


  - **Property 6: 複数のログの形式は一貫している**
  - **検証: 要件 4.5**



- [ ] 3. フロントエンド型定義の更新
  - `Activity` インターフェースに `employee` フィールドを追加（オプショナル）
  - `frontend/src/types/index.ts` を更新
  - _要件: 4.1, 4.2_

- [ ] 4. 表示名生成ユーティリティ関数を実装
  - `frontend/src/utils/displayName.ts` を作成
  - `getDisplayNameFromEmail` 関数を実装
  - メールアドレスから姓の最初の文字を抽出
  - 無効な入力に対してデフォルト値（"?"）を返す
  - _要件: 2.1, 2.2, 2.3, 2.5_

- [ ]* 4.1 表示名生成関数のユニットテストを作成
  - "tomoko.kunihiro@ifoo-oita.com" → "K" のテスト
  - "john@example.com" → "J" のテスト
  - 空文字列 → "?" のテスト


  - 無効な形式 → "?" のテスト
  - _要件: 2.2, 2.3, 2.5_

- [ ]* 4.2 Property 2 のプロパティベーステストを作成
  - **Property 2: メールアドレスから表示名への変換は決定的である**
  - **検証: 要件 2.1, 2.4**

- [ ] 5. 日時フォーマットユーティリティ関数を実装
  - `frontend/src/utils/dateFormat.ts` を作成


  - `formatDateTime` 関数を実装
  - ISO 8601 形式を「2025/12/1 14:30」形式に変換
  - _要件: 1.3_

- [ ]* 5.1 日時フォーマット関数のユニットテストを作成
  - 各種日時形式の変換をテスト
  - タイムゾーンを考慮したテスト
  - _要件: 1.3_

- [ ] 6. SellerDetailPage の通話メモダイアログを更新
  - 過去の通話メモリストに担当者名を追加
  - 「K 2025/12/1 14:30」形式で表示



  - employee が null の場合は日時のみ表示
  - _要件: 1.1, 1.3, 1.5_

- [ ]* 6.1 Property 3 のプロパティベーステストを作成
  - **Property 3: 表示形式は一貫している**
  - **検証: 要件 1.3**

- [ ]* 6.2 Property 4 のプロパティベーステストを作成
  - **Property 4: 複数の担当者が正しく区別される**
  - **検証: 要件 1.4**

- [ ] 7. チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、問題があればユーザーに質問する

- [ ]* 8. 統合テストを作成
  - エンドツーエンドフローのテスト
  - UI 表示テスト
  - _要件: 1.1, 1.3, 1.4_
