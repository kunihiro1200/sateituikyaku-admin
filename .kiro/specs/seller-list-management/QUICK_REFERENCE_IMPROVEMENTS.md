# 📋 Spec改善クイックリファレンス

## 🎯 最優先で実装すべき改善（今すぐ実行可能）

### 1. 要件の優先順位付け（MoSCoW法）

現在の`requirements.md`の冒頭に以下のセクションを追加してください。

```markdown
## 要件の優先順位

### Must Have（必須 - MVP に含める）
- ✅ 要件1: 売主登録
- ✅ 要件7: 認証
- ✅ 要件9: 検索・フィルタリング
- ✅ 要件10: パフォーマンス
- ✅ 要件11: 売主番号生成
- ✅ 要件31: エラーハンドリング
- ✅ 要件32: データ整合性

### Should Have（重要 - Phase 1で実装）
- 🔶 要件2: 自動査定
- 🔶 要件4: 追客活動記録
- 🔶 要件5: フォローアップ管理
- 🔶 要件12: 重複検出
- 🔶 要件13: 物件情報管理
- 🔶 要件15: 査定額管理

### Could Have（あれば良い - Phase 2で実装）
- 🔷 要件3: 査定メール送信
- 🔷 要件6: 訪問査定予約
- 🔷 要件8: 活動ログ自動記録
- 🔷 要件14: 反響管理
- 🔷 要件16-28: 詳細機能

### Won't Have（今回は対象外）
- ⭕ 要件29: 手動更新（自動更新で代替）
- ⭕ 要件30: 自動更新（Phase 3で実装）
```

### 2. 要件2（自動査定）の具体化

要件2の受入基準2を以下のように置き換えてください。

```markdown
2. **WHEN** 戸建ての査定額を計算する場合
   **THEN** システムは以下の計算式を適用しなければならない:
   
   **土地評価額の計算:**
   - 土地評価額 = 土地面積(㎡) × 固定資産税路線価(円/㎡)
   
   **建物評価額の計算:**
   - 構造別単価:
     * 木造: 150,000円/㎡
     * 軽量鉄骨: 180,000円/㎡
     * 鉄骨: 200,000円/㎡
     * その他: 170,000円/㎡
   - 減価率 = 1 - (築年数 × 0.015)
   - 建物評価額 = 建物面積(㎡) × 構造別単価 × 減価率
   
   **査定額の計算:**
   - 査定額1（最低額）= 土地評価額 × 0.8 + 建物評価額 × 0.7
   - 査定額2（中間額）= 土地評価額 × 1.0 + 建物評価額 × 0.8
   - 査定額3（最高額）= 土地評価額 × 1.2 + 建物評価額 × 0.9
   
   **異常値チェック:**
   - IF 査定額1 < 1,000,000円 OR 査定額3 > 1,000,000,000円
   - THEN 警告メッセージを表示する
```

### 3. 要件20の分割

要件20を以下の3つに分割してください。

```markdown
### 要件20A: 競合情報の表示条件

**ユーザーストーリー:** 社員として、競合情報を適切なタイミングで入力したいので、ステータスに応じて競合情報セクションが表示されるようにしたい

#### 受入基準

1. WHEN 売主のステータスが「専任媒介他決」「追客他決」「追客不要他決」「専任他決」「一般」のいずれかである場合、システムは競合情報セクション全体を表示しなければならない
2. WHEN ステータスが上記以外に変更された場合、システムは競合情報セクションを非表示にしなければならない

---

### 要件20B: 競合情報の必須入力

**ユーザーストーリー:** 社員として、競合分析を確実に行いたいので、競合情報セクションが表示されている場合は必須項目を入力しなければ保存できないようにしたい

#### 受入基準

1. WHEN 競合情報セクションが表示されている場合、システムは以下のフィールドを必須項目として入力を要求しなければならない:
   - 競合名
   - 専任・他決要因
   - 他決対策
   - 契約年月
   - 専任他決打合せ

2. WHEN 必須項目が未入力のまま保存しようとした場合、システムはエラーメッセージを表示し保存を拒否しなければならない

---

### 要件20C: 専任・他決要因の選択

**ユーザーストーリー:** 社員として、他決の要因を詳細に分析したいので、27個の選択肢から複数選択できるようにしたい

#### 受入基準

1. WHEN 専任・他決要因を選択する場合、システムは以下の27個の選択肢から複数選択できなければならない:
   - 知り合い
   - 価格が高い
   - 決定権者の把握
   - 連絡不足
   - 購入物件の紹介
   - 購入希望者がいる
   - 以前つきあいがあった不動産
   - ヒアリング不足
   - 担当者の対応が良い
   - 査定書郵送
   - １番電話のスピード
   - 対応スピード
   - 買取保証
   - 追客電話の対応
   - 説明が丁寧
   - 詳細な調査
   - 不誠実・やるべきことをしない
   - 定期的な追客電話
   - HPの口コミ
   - 売買に強い
   - 仲介手数料のサービス
   - 仲介手数料以外のサービス
   - 妥当な査定額
   - 定期的なメール配信
   - 提案力
   - 熱意
   - その他

2. WHEN 専任他決の打合せ状況を選択する場合、システムは「未」「完了」のラジオボタンで選択できなければならない
```

## 📊 改善の優先順位

### 🔴 最優先（今週中に実施）
1. ✅ 要件の優先順位付け（MoSCoW法）
2. ✅ 要件2の具体化
3. ✅ 要件20の分割

### 🟡 高優先度（来週中に実施）
4. パフォーマンス指標の追加
5. セキュリティ要件の強化
6. エラーハンドリングの詳細化

### 🟢 中優先度（Phase 2で実施）
7. テスト戦略の明確化（要件33）
8. データ移行要件の追加（要件34）
9. 監視・運用要件の追加（要件35）

## 🎯 実装手順

### ステップ1: requirements.mdのバックアップ
```bash
cp .kiro/specs/seller-list-management/requirements.md .kiro/specs/seller-list-management/requirements_v1_backup.md
```

### ステップ2: 優先順位セクションの追加
`requirements.md`の「用語集」の後に「要件の優先順位」セクションを追加

### ステップ3: 要件2の更新
要件2の受入基準2を具体的な計算式に置き換え

### ステップ4: 要件20の分割
要件20を要件20A、20B、20Cに分割

### ステップ5: 変更履歴の記録
`requirements.md`の冒頭に以下を追加:

```markdown
## 変更履歴

### v2.0 (2025-01-09)
- 要件の優先順位付けを追加（MoSCoW法）
- 要件2（自動査定）の受入基準を具体化
- 要件20（競合情報管理）を3つに分割（20A、20B、20C）

### v1.0 (初版)
- 初版作成
```

## ✅ 完了チェックリスト

- [ ] requirements.mdをバックアップ
- [ ] 優先順位セクションを追加
- [ ] 要件2を更新
- [ ] 要件20を分割
- [ ] 変更履歴を記録
- [ ] tasks.mdを確認（新しい要件に対応しているか）
- [ ] design.mdを確認（新しい要件に対応しているか）
- [ ] チームレビューを実施

## 📝 参考資料

詳細な改善提案は以下のファイルを参照してください:
- `SPEC_IMPROVEMENT_RECOMMENDATIONS.md`: 全ての改善提案の詳細
- `requirements.md`: 現在の要件定義書
- `tasks.md`: 実装タスク一覧
- `design.md`: 設計ドキュメント

## 💡 Tips

### MoSCoW法とは？
- **Must Have**: なければシステムが成立しない
- **Should Have**: 重要だが、なくても代替手段がある
- **Could Have**: あれば便利だが、優先度は低い
- **Won't Have**: 今回のスコープには含めない

### 受入基準の書き方
- **具体的**: 数値や計算式を明記
- **測定可能**: テストで検証できる
- **実現可能**: 技術的に実装可能
- **関連性**: ユーザーストーリーに関連
- **期限付き**: いつまでに実装するか明確

## 🚀 次のステップ

1. このクイックリファレンスに従って`requirements.md`を更新
2. チームレビューを実施
3. 合意が得られたら、`tasks.md`を更新
4. 実装を開始

---

**作成日**: 2025-01-09  
**バージョン**: 1.0  
**作成者**: Kiro AI Assistant
