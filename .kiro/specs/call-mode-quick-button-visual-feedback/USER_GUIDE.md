# User Guide: Call Mode Quick Button Visual Feedback

## 概要

コールモードページのクイックボタン（EmailテンプレートとSMSテンプレート）に視覚的フィードバック機能が追加されました。この機能により、ボタンの使用状態が一目で分かるようになります。

## 機能説明

### ボタンの状態

クイックボタンには3つの状態があります：

#### 1. 通常状態（未使用）

**見た目:**
- 背景色: 白（デフォルト）
- テキスト: 黒（通常の色）
- バッジ: なし

**動作:**
- クリック可能
- ホバー時に背景色が変わる
- カーソルが`pointer`（指マーク）になる

**意味:**
- このボタンはまだ使用されていません
- クリックしてテンプレートを送信できます

#### 2. 保存待ち状態（Pending）

**見た目:**
- 背景色: 黄色（`#fff9c4`）
- テキスト: グレー（`#9e9e9e`）+ 取り消し線
- バッジ: 黄色の「保存待ち」バッジ

**動作:**
- クリック不可
- ホバー時に背景色が変わらない
- カーソルが`not-allowed`（禁止マーク）になる

**意味:**
- このボタンがクリックされましたが、まだ保存されていません
- 売主情報を保存すると「使用済み」状態に変わります
- 保存せずにページを離れると、この状態はリセットされます

#### 3. 使用済み状態（Persisted）

**見た目:**
- 背景色: グレー（`#f5f5f5`）
- テキスト: グレー（`#9e9e9e`）+ 取り消し線
- バッジ: グレーの「使用済み」バッジ

**動作:**
- クリック不可
- ホバー時に背景色が変わらない
- カーソルが`not-allowed`（禁止マーク）になる

**意味:**
- このボタンは既に使用され、保存されています
- 同じテンプレートを再度送信することはできません
- この状態は永続的に保存されます

## 使い方

### 基本的な使い方

1. **テンプレートを選択**
   - Emailテンプレートまたは SMSテンプレートのドロップダウンを開く
   - 送信したいテンプレートを選択

2. **状態の確認**
   - 選択したテンプレートの状態を確認
   - 通常状態（白背景）なら送信可能
   - 保存待ち（黄色背景）または使用済み（グレー背景）なら送信不可

3. **テンプレートを送信**
   - 通常状態のテンプレートをクリック
   - テンプレートが送信され、ボタンが「保存待ち」状態になる

4. **売主情報を保存**
   - ページ下部の「保存」ボタンをクリック
   - 「保存待ち」状態のボタンが「使用済み」状態に変わる

### 複数のテンプレートを送信する場合

1. **最初のテンプレートを選択して送信**
   - ボタンが「保存待ち」状態（黄色背景）になる

2. **2つ目のテンプレートを選択して送信**
   - 2つ目のボタンも「保存待ち」状態になる
   - 最初のボタンは「保存待ち」状態のまま

3. **売主情報を保存**
   - すべての「保存待ち」状態のボタンが「使用済み」状態（グレー背景）に変わる

### 状態のリセット

**保存待ち状態のリセット:**
- ページをリロードすると、「保存待ち」状態はリセットされます
- 別の売主ページに移動すると、「保存待ち」状態はリセットされます

**使用済み状態の永続化:**
- 「使用済み」状態は永続的に保存されます
- ページをリロードしても、「使用済み」状態は保持されます
- 別の売主ページに移動して戻っても、「使用済み」状態は保持されます

## 視覚的なガイド

### Emailテンプレートボタン

```
┌─────────────────────────────────────────┐
│ 通常状態（未使用）                        │
│ ┌─────────────────────────────────────┐ │
│ │ 物件紹介メール                        │ │
│ │ 件名: 新着物件のご紹介                │ │
│ │ 本文: お世話になっております...      │ │
│ └─────────────────────────────────────┘ │
│ 背景: 白、テキスト: 黒                   │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 保存待ち状態（Pending）                  │
│ ┌─────────────────────────────────────┐ │
│ │ 物件紹介メール [保存待ち]             │ │
│ │ 件名: 新着物件のご紹介                │ │
│ │ 本文: お世話になっております...      │ │
│ └─────────────────────────────────────┘ │
│ 背景: 黄色、テキスト: グレー + 取り消し線│
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 使用済み状態（Persisted）                │
│ ┌─────────────────────────────────────┐ │
│ │ 物件紹介メール [使用済み]             │ │
│ │ 件名: 新着物件のご紹介                │ │
│ │ 本文: お世話になっております...      │ │
│ └─────────────────────────────────────┘ │
│ 背景: グレー、テキスト: グレー + 取り消し線│
└─────────────────────────────────────────┘
```

### SMSテンプレートボタン

```
┌─────────────────────────────────────────┐
│ 通常状態（未使用）                        │
│ ┌─────────────────────────────────────┐ │
│ │ 物件紹介SMS                           │ │
│ └─────────────────────────────────────┘ │
│ 背景: 白、テキスト: 黒                   │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 保存待ち状態（Pending）                  │
│ ┌─────────────────────────────────────┐ │
│ │ 物件紹介SMS [保存待ち]                │ │
│ └─────────────────────────────────────┘ │
│ 背景: 黄色、テキスト: グレー + 取り消し線│
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 使用済み状態（Persisted）                │
│ ┌─────────────────────────────────────┐ │
│ │ 物件紹介SMS [使用済み]                │ │
│ └─────────────────────────────────────┘ │
│ 背景: グレー、テキスト: グレー + 取り消し線│
└─────────────────────────────────────────┘
```

## よくある質問（FAQ）

### Q1: なぜボタンが無効化されるのですか？

**A:** ボタンが無効化される理由は2つあります：

1. **保存待ち状態（黄色背景）**: ボタンをクリックしましたが、まだ売主情報を保存していません。保存すると「使用済み」状態に変わります。

2. **使用済み状態（グレー背景）**: このテンプレートは既に送信され、保存されています。同じテンプレートを再度送信することはできません。

### Q2: 保存待ち状態のボタンを元に戻すことはできますか？

**A:** はい、以下の方法で元に戻すことができます：

- ページをリロードする
- 別の売主ページに移動する

ただし、売主情報を保存すると「使用済み」状態になり、元に戻すことはできません。

### Q3: 使用済み状態のボタンを再度使用することはできますか？

**A:** いいえ、使用済み状態のボタンは再度使用することはできません。これは、同じテンプレートを誤って複数回送信することを防ぐための機能です。

### Q4: 複数のテンプレートを同時に送信できますか？

**A:** はい、複数のテンプレートを選択して送信できます。各テンプレートは独立して「保存待ち」状態になり、売主情報を保存すると、すべての「保存待ち」状態のボタンが「使用済み」状態に変わります。

### Q5: バッジの色の意味は何ですか？

**A:** バッジの色は以下の意味を持ちます：

- **黄色（warning）**: 保存待ち状態。売主情報を保存する必要があります。
- **グレー（default）**: 使用済み状態。既に保存されています。

### Q6: スクリーンリーダーを使用していますが、ボタンの状態が分かりますか？

**A:** はい、スクリーンリーダーでボタンの状態が読み上げられます。例えば、「物件紹介メール - 保存待ち」や「物件紹介メール - 使用済み」のように読み上げられます。

### Q7: キーボードだけで操作できますか？

**A:** はい、キーボードだけで操作できます：

- **Tab**: ボタン間を移動
- **Enter**: ボタンを選択（有効な場合）
- **Esc**: ドロップダウンを閉じる

無効化されたボタンもフォーカス可能ですが、Enterキーを押しても選択されません。

## トラブルシューティング

### 問題: ボタンの状態が保存されない

**原因:** ブラウザのローカルストレージが無効になっている可能性があります。

**解決策:**
1. ブラウザの設定を確認
2. ローカルストレージを有効にする
3. ページをリロード

### 問題: ボタンの背景色が表示されない

**原因:** ブラウザのキャッシュが古い可能性があります。

**解決策:**
1. ブラウザのキャッシュをクリア
2. ページをリロード（Ctrl+F5 または Cmd+Shift+R）

### 問題: バッジが小さくて読みにくい

**原因:** ブラウザのズームレベルが低い可能性があります。

**解決策:**
1. ブラウザのズームレベルを上げる（Ctrl++ または Cmd++）
2. ブラウザの設定でフォントサイズを大きくする

### 問題: ホバー時に背景色が変わらない

**原因:** ボタンが無効化されている可能性があります。

**解決策:**
- ボタンの状態を確認
- 保存待ち（黄色背景）または使用済み（グレー背景）の場合、ホバー時に背景色は変わりません

## サポート

問題が解決しない場合は、以下の情報を含めてサポートチームに連絡してください：

- ブラウザの種類とバージョン
- 問題が発生した日時
- 問題の詳細な説明
- スクリーンショット（可能な場合）

## 更新履歴

- **2025年1月1日**: 初版リリース
  - Emailテンプレートボタンの視覚的フィードバック追加
  - SMSテンプレートボタンの視覚的フィードバック追加
  - バッジのサイズ拡大
  - アクセシビリティの向上

