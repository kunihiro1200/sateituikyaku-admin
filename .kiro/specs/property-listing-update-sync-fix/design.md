# ç‰©ä»¶ãƒªã‚¹ãƒˆæ›´æ–°åŒæœŸä¿®æ­£ - æŠ€è¡“è¨­è¨ˆ

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ğŸ¨ è¨­è¨ˆå®Œäº†

## æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€æ—¢å­˜ç‰©ä»¶ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ›´æ–°ï¼ˆç‰¹ã«ATBBçŠ¶æ³ï¼‰ãŒã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«è‡ªå‹•åŒæœŸã•ã‚Œãªã„å•é¡Œã‚’ä¿®æ­£ã™ã‚‹ãŸã‚ã®æŠ€è¡“è¨­è¨ˆã‚’å®šç¾©ã—ã¾ã™ã€‚

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ                      â”‚
â”‚                    (ç‰©ä»¶ãƒªã‚¹ãƒˆãƒã‚¹ã‚¿ãƒ¼)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ Google Sheets API
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EnhancedAutoSyncService                         â”‚
â”‚              (å®šæœŸåŒæœŸãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼)                           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  èµ·å‹•æ™‚: 5ç§’å¾Œã«åˆå›åŒæœŸå®Ÿè¡Œ                          â”‚  â”‚
â”‚  â”‚  å®šæœŸå®Ÿè¡Œ: 5åˆ†é–“éš”ã§è‡ªå‹•åŒæœŸ                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ syncPropertyListingUpdates()
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PropertyListingSyncService                           â”‚
â”‚         (ç‰©ä»¶ãƒªã‚¹ãƒˆåŒæœŸã‚µãƒ¼ãƒ“ã‚¹)                              â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰å…¨ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿å–å¾—              â”‚  â”‚
â”‚  â”‚  2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æ—¢å­˜ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿å–å¾—                â”‚  â”‚
â”‚  â”‚  3. å·®åˆ†æ¤œå‡ºï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å˜ä½ï¼‰                        â”‚  â”‚
â”‚  â”‚  4. å¤‰æ›´ãŒã‚ã£ãŸç‰©ä»¶ã®ã¿æ›´æ–°                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ Supabase REST API
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹                         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ property_listingsâ”‚  â”‚   sync_logs      â”‚               â”‚
â”‚  â”‚  (ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿)    â”‚  â”‚  (åŒæœŸå±¥æ­´)      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### 1. EnhancedAutoSyncService

**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/src/services/EnhancedAutoSyncService.ts`

**è²¬å‹™**:
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼èµ·å‹•æ™‚ã«è‡ªå‹•èµ·å‹•
- å®šæœŸçš„ã«åŒæœŸå‡¦ç†ã‚’å®Ÿè¡Œ
- åŒæœŸçµæœã®ãƒ­ã‚°è¨˜éŒ²

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```typescript
class EnhancedAutoSyncService {
  // åˆæœŸåŒ–ï¼ˆã‚µãƒ¼ãƒãƒ¼èµ·å‹•æ™‚ã«è‡ªå‹•å®Ÿè¡Œï¼‰
  constructor() {
    this.startPeriodicSync();
  }

  // å®šæœŸåŒæœŸã®é–‹å§‹
  private startPeriodicSync(): void {
    // 5ç§’å¾Œã«åˆå›åŒæœŸ
    setTimeout(() => this.runSync(), 5000);
    
    // 5åˆ†é–“éš”ã§å®šæœŸåŒæœŸ
    setInterval(() => this.runSync(), 5 * 60 * 1000);
  }

  // åŒæœŸå®Ÿè¡Œ
  private async runSync(): Promise<void> {
    await this.syncPropertyListingUpdates();
  }

  // ç‰©ä»¶ãƒªã‚¹ãƒˆæ›´æ–°åŒæœŸ
  private async syncPropertyListingUpdates(): Promise<void> {
    const result = await propertyListingSyncService
      .syncUpdatedPropertyListings();
    
    // sync_logsã«è¨˜éŒ²
    await this.logSyncResult(result);
  }
}
```


### 2. PropertyListingSyncService

**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/src/services/PropertyListingSyncService.ts`

**è²¬å‹™**:
- ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å·®åˆ†æ¤œå‡º
- å¤‰æ›´ãŒã‚ã£ãŸç‰©ä»¶ã®æ›´æ–°å‡¦ç†
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒªãƒˆãƒ©ã‚¤

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```typescript
class PropertyListingSyncService {
  // æ›´æ–°ã•ã‚ŒãŸç‰©ä»¶ã®åŒæœŸ
  async syncUpdatedPropertyListings(): Promise<SyncResult> {
    const sheetData = await this.fetchFromSpreadsheet();
    const dbData = await this.fetchFromDatabase();
    
    const updates = this.detectChanges(sheetData, dbData);
    
    const results = {
      updated: 0,
      errors: [] as SyncError[]
    };
    
    for (const update of updates) {
      try {
        await this.updatePropertyListing(update);
        results.updated++;
      } catch (error) {
        results.errors.push({
          propertyNumber: update.propertyNumber,
          error: error.message
        });
      }
    }
    
    return results;
  }

  // å·®åˆ†æ¤œå‡º
  private detectChanges(
    sheetData: PropertyData[],
    dbData: PropertyData[]
  ): PropertyUpdate[] {
    const updates: PropertyUpdate[] = [];
    
    for (const sheetRow of sheetData) {
      const dbRow = dbData.find(
        d => d.property_number === sheetRow.property_number
      );
      
      if (!dbRow) continue; // æ–°è¦ç‰©ä»¶ã¯ã‚¹ã‚­ãƒƒãƒ—
      
      const changedFields = this.compareFields(sheetRow, dbRow);
      
      if (changedFields.length > 0) {
        updates.push({
          propertyNumber: sheetRow.property_number,
          fields: changedFields
        });
      }
    }
    
    return updates;
  }

  // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ¯”è¼ƒ
  private compareFields(
    sheetRow: PropertyData,
    dbRow: PropertyData
  ): FieldChange[] {
    const changes: FieldChange[] = [];
    
    // ç›£è¦–å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
    const fieldsToWatch = [
      'atbb_status',
      'price',
      'land_area',
      'building_area',
      'status',
      // ... ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
    ];
    
    for (const field of fieldsToWatch) {
      if (sheetRow[field] !== dbRow[field]) {
        changes.push({
          field,
          oldValue: dbRow[field],
          newValue: sheetRow[field]
        });
      }
    }
    
    return changes;
  }

  // ç‰©ä»¶æ›´æ–°
  private async updatePropertyListing(
    update: PropertyUpdate
  ): Promise<void> {
    const updateData = {};
    
    for (const change of update.fields) {
      updateData[change.field] = change.newValue;
    }
    
    await supabase
      .from('property_listings')
      .update(updateData)
      .eq('property_number', update.propertyNumber);
  }
}
```

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### åŒæœŸå‡¦ç†ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³

```mermaid
sequenceDiagram
    participant Server as ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼
    participant Auto as EnhancedAutoSyncService
    participant Sync as PropertyListingSyncService
    participant Sheet as Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ
    participant DB as Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
    participant Log as sync_logsãƒ†ãƒ¼ãƒ–ãƒ«

    Server->>Auto: èµ·å‹•
    Auto->>Auto: startPeriodicSync()
    Note over Auto: 5ç§’å¾…æ©Ÿ
    Auto->>Sync: syncPropertyListingUpdates()
    
    Sync->>Sheet: å…¨ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿å–å¾—
    Sheet-->>Sync: ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿é…åˆ—
    
    Sync->>DB: æ—¢å­˜ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿å–å¾—
    DB-->>Sync: ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿é…åˆ—
    
    Sync->>Sync: detectChanges()
    Note over Sync: å·®åˆ†æ¤œå‡º
    
    loop å¤‰æ›´ãŒã‚ã£ãŸç‰©ä»¶ã”ã¨
        Sync->>DB: UPDATE property_listings
        DB-->>Sync: æ›´æ–°å®Œäº†
    end
    
    Sync-->>Auto: åŒæœŸçµæœ
    Auto->>Log: åŒæœŸå±¥æ­´ã‚’è¨˜éŒ²
    
    Note over Auto: 5åˆ†å¾…æ©Ÿ
    Auto->>Sync: syncPropertyListingUpdates()
    Note over Auto: å®šæœŸå®Ÿè¡Œç¶™ç¶š
```

### ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GoogleSheetsClient.fetchPropertyListings()                 â”‚
â”‚  â†“                                                           â”‚
â”‚  ç”Ÿãƒ‡ãƒ¼ã‚¿: [["AA4885", "å…¬é–‹ä¸­", "5000ä¸‡å††", ...], ...]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: ã‚«ãƒ©ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PropertyListingColumnMapper.mapRowToPropertyListing()      â”‚
â”‚  â†“                                                           â”‚
â”‚  ãƒãƒƒãƒ—æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿: {                                         â”‚
â”‚    property_number: "AA4885",                               â”‚
â”‚    atbb_status: "å…¬é–‹ä¸­",                                   â”‚
â”‚    price: 50000000,                                         â”‚
â”‚    ...                                                       â”‚
â”‚  }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã¨æ¯”è¼ƒ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  compareFields(sheetRow, dbRow)                             â”‚
â”‚  â†“                                                           â”‚
â”‚  å·®åˆ†: [                                                     â”‚
â”‚    { field: "atbb_status",                                  â”‚
â”‚      oldValue: "éå…¬é–‹",                                    â”‚
â”‚      newValue: "å…¬é–‹ä¸­" }                                   â”‚
â”‚  ]                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UPDATE property_listings                                   â”‚
â”‚  SET atbb_status = 'å…¬é–‹ä¸­'                                 â”‚
â”‚  WHERE property_number = 'AA4885'                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### property_listingsãƒ†ãƒ¼ãƒ–ãƒ«

```sql
CREATE TABLE property_listings (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  property_number TEXT UNIQUE NOT NULL,
  
  -- ATBBé–¢é€£
  atbb_status TEXT,
  atbb_public_folder TEXT,
  
  -- åŸºæœ¬æƒ…å ±
  price NUMERIC,
  land_area NUMERIC,
  building_area NUMERIC,
  status TEXT,
  
  -- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  last_synced_at TIMESTAMPTZ
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_property_listings_property_number 
  ON property_listings(property_number);
CREATE INDEX idx_property_listings_last_synced_at 
  ON property_listings(last_synced_at);
```

### sync_logsãƒ†ãƒ¼ãƒ–ãƒ«

```sql
CREATE TABLE sync_logs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  sync_type TEXT NOT NULL,
  status TEXT NOT NULL,
  records_processed INTEGER,
  error_message TEXT,
  started_at TIMESTAMPTZ NOT NULL,
  completed_at TIMESTAMPTZ,
  duration_ms INTEGER
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_sync_logs_sync_type 
  ON sync_logs(sync_type);
CREATE INDEX idx_sync_logs_started_at 
  ON sync_logs(started_at DESC);
```

### TypeScriptå‹å®šç¾©

```typescript
// ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿
interface PropertyData {
  property_number: string;
  atbb_status?: string;
  atbb_public_folder?: string;
  price?: number;
  land_area?: number;
  building_area?: number;
  status?: string;
  last_synced_at?: Date;
}

// åŒæœŸçµæœ
interface SyncResult {
  updated: number;
  errors: SyncError[];
}

// åŒæœŸã‚¨ãƒ©ãƒ¼
interface SyncError {
  propertyNumber: string;
  error: string;
}

// ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å¤‰æ›´
interface FieldChange {
  field: string;
  oldValue: any;
  newValue: any;
}

// ç‰©ä»¶æ›´æ–°
interface PropertyUpdate {
  propertyNumber: string;
  fields: FieldChange[];
}

// åŒæœŸãƒ­ã‚°
interface SyncLog {
  sync_type: 'property_listing_update';
  status: 'success' | 'error';
  records_processed: number;
  error_message?: string;
  started_at: Date;
  completed_at?: Date;
  duration_ms?: number;
}
```

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆ

### ã‚¨ãƒ©ãƒ¼åˆ†é¡

```typescript
enum SyncErrorType {
  // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼
  NETWORK_ERROR = 'NETWORK_ERROR',
  
  // APIåˆ¶é™ã‚¨ãƒ©ãƒ¼
  RATE_LIMIT_ERROR = 'RATE_LIMIT_ERROR',
  
  // ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚¨ãƒ©ãƒ¼
  VALIDATION_ERROR = 'VALIDATION_ERROR',
  
  // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼
  DATABASE_ERROR = 'DATABASE_ERROR',
  
  // ä¸æ˜ãªã‚¨ãƒ©ãƒ¼
  UNKNOWN_ERROR = 'UNKNOWN_ERROR'
}
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŒæœŸå‡¦ç†é–‹å§‹                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  try {                                                       â”‚
â”‚    ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿å–å¾—                                            â”‚
â”‚    å·®åˆ†æ¤œå‡º                                                  â”‚
â”‚    ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°                                          â”‚
â”‚  }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
              ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿï¼Ÿ
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
       YES                       NO
        â”‚                         â”‚
        â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚¨ãƒ©ãƒ¼åˆ†é¡      â”‚    â”‚  æˆåŠŸãƒ­ã‚°è¨˜éŒ²    â”‚
â”‚  â†“               â”‚    â”‚  â†“               â”‚
â”‚  ãƒªãƒˆãƒ©ã‚¤åˆ¤å®š    â”‚    â”‚  å‡¦ç†å®Œäº†        â”‚
â”‚  â†“               â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ï¼Ÿ  â”‚
â”‚  â†“               â”‚
â”‚  YES â†’ å†å®Ÿè¡Œ    â”‚
â”‚  NO  â†’ ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯

```typescript
class RetryHandler {
  private maxRetries = 3;
  private retryDelay = 1000; // 1ç§’

  async executeWithRetry<T>(
    operation: () => Promise<T>,
    errorType: SyncErrorType
  ): Promise<T> {
    let lastError: Error;
    
    for (let attempt = 1; attempt <= this.maxRetries; attempt++) {
      try {
        return await operation();
      } catch (error) {
        lastError = error;
        
        // ãƒªãƒˆãƒ©ã‚¤ä¸å¯èƒ½ãªã‚¨ãƒ©ãƒ¼
        if (!this.isRetryable(errorType)) {
          throw error;
        }
        
        // æœ€å¾Œã®è©¦è¡Œ
        if (attempt === this.maxRetries) {
          throw error;
        }
        
        // å¾…æ©Ÿã—ã¦ãƒªãƒˆãƒ©ã‚¤
        await this.delay(this.retryDelay * attempt);
      }
    }
    
    throw lastError;
  }

  private isRetryable(errorType: SyncErrorType): boolean {
    return [
      SyncErrorType.NETWORK_ERROR,
      SyncErrorType.RATE_LIMIT_ERROR
    ].includes(errorType);
  }

  private delay(ms: number): Promise<void> {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}
```


## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### å·®åˆ†æ¤œå‡ºã®æœ€é©åŒ–

**å•é¡Œ**: å…¨ç‰©ä»¶ã‚’æ¯å›æ¯”è¼ƒã™ã‚‹ã¨å‡¦ç†æ™‚é–“ãŒé•·ããªã‚‹

**è§£æ±ºç­–**: 
1. last_synced_atãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ´»ç”¨
2. å¤‰æ›´ãŒã‚ã£ãŸå¯èƒ½æ€§ã®ã‚ã‚‹ç‰©ä»¶ã®ã¿ã‚’æ¯”è¼ƒ
3. ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å˜ä½ã§ã®æ¯”è¼ƒ

```typescript
class OptimizedSyncService {
  // æœ€é©åŒ–ã•ã‚ŒãŸå·®åˆ†æ¤œå‡º
  async detectChangesOptimized(): Promise<PropertyUpdate[]> {
    // å‰å›ã®åŒæœŸæ™‚åˆ»ã‚’å–å¾—
    const lastSyncTime = await this.getLastSyncTime();
    
    // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰å…¨ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆå¿…é ˆï¼‰
    const sheetData = await this.fetchFromSpreadsheet();
    
    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å‰å›åŒæœŸä»¥é™ã«å¤‰æ›´ãŒãªã„ç‰©ä»¶ã‚’é™¤å¤–
    const dbData = await this.fetchRecentlyUpdated(lastSyncTime);
    
    // å·®åˆ†æ¤œå‡ºï¼ˆå¯¾è±¡ç‰©ä»¶ãŒçµã‚‰ã‚Œã¦ã„ã‚‹ï¼‰
    return this.detectChanges(sheetData, dbData);
  }

  // æœ€è¿‘æ›´æ–°ã•ã‚ŒãŸç‰©ä»¶ã®ã¿å–å¾—
  private async fetchRecentlyUpdated(
    since: Date
  ): Promise<PropertyData[]> {
    return await supabase
      .from('property_listings')
      .select('*')
      .or(`last_synced_at.is.null,last_synced_at.lt.${since.toISOString()}`);
  }
}
```

### ãƒãƒƒãƒæ›´æ–°ã®æœ€é©åŒ–

**å•é¡Œ**: 1ä»¶ãšã¤æ›´æ–°ã™ã‚‹ã¨é…ã„

**è§£æ±ºç­–**: å¯èƒ½ãªé™ã‚Šãƒãƒƒãƒæ›´æ–°ã‚’ä½¿ç”¨

```typescript
class BatchUpdateService {
  // ãƒãƒƒãƒæ›´æ–°
  async updateInBatch(updates: PropertyUpdate[]): Promise<void> {
    const batchSize = 50;
    
    for (let i = 0; i < updates.length; i += batchSize) {
      const batch = updates.slice(i, i + batchSize);
      
      // ä¸¦åˆ—å®Ÿè¡Œ
      await Promise.all(
        batch.map(update => this.updatePropertyListing(update))
      );
    }
  }
}
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥

```typescript
class CacheManager {
  private cache = new Map<string, PropertyData>();
  private cacheExpiry = 5 * 60 * 1000; // 5åˆ†

  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—
  async getWithCache(propertyNumber: string): Promise<PropertyData> {
    const cached = this.cache.get(propertyNumber);
    
    if (cached && !this.isExpired(cached)) {
      return cached;
    }
    
    const fresh = await this.fetchFromDatabase(propertyNumber);
    this.cache.set(propertyNumber, fresh);
    
    return fresh;
  }

  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
  clearCache(): void {
    this.cache.clear();
  }
}
```

## ç›£è¦–ã¨ãƒ­ã‚°è¨­è¨ˆ

### ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«

```typescript
enum LogLevel {
  DEBUG = 'DEBUG',
  INFO = 'INFO',
  WARN = 'WARN',
  ERROR = 'ERROR'
}
```

### ãƒ­ã‚°å‡ºåŠ›ä¾‹

```typescript
class SyncLogger {
  // åŒæœŸé–‹å§‹ãƒ­ã‚°
  logSyncStart(): void {
    console.log('ğŸ”„ [INFO] Starting property listing update sync...');
  }

  // åŒæœŸå®Œäº†ãƒ­ã‚°
  logSyncComplete(result: SyncResult): void {
    console.log(
      `âœ… [INFO] Property listing update sync completed: ` +
      `${result.updated} updated, ${result.errors.length} errors`
    );
  }

  // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
  logError(error: SyncError): void {
    console.error(
      `âŒ [ERROR] Failed to update ${error.propertyNumber}: ` +
      `${error.error}`
    );
  }

  // è©³ç´°ãƒ­ã‚°ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
  logDetail(propertyNumber: string, changes: FieldChange[]): void {
    console.log(
      `ğŸ“ [DEBUG] ${propertyNumber}: ` +
      `${changes.length} fields changed`
    );
    
    for (const change of changes) {
      console.log(
        `  - ${change.field}: ` +
        `"${change.oldValue}" â†’ "${change.newValue}"`
      );
    }
  }
}
```

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†

```typescript
interface SyncMetrics {
  // å‡¦ç†æ™‚é–“
  duration_ms: number;
  
  // å‡¦ç†ä»¶æ•°
  total_checked: number;
  total_updated: number;
  total_errors: number;
  
  // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
  avg_update_time_ms: number;
  
  // ã‚¨ãƒ©ãƒ¼ç‡
  error_rate: number;
}

class MetricsCollector {
  async collectMetrics(result: SyncResult): Promise<SyncMetrics> {
    return {
      duration_ms: result.duration,
      total_checked: result.checked,
      total_updated: result.updated,
      total_errors: result.errors.length,
      avg_update_time_ms: result.duration / result.updated,
      error_rate: result.errors.length / result.checked
    };
  }
}
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### èªè¨¼ãƒ»èªå¯

```typescript
class SecurityManager {
  // Google Sheets APIèªè¨¼
  async authenticateGoogleSheets(): Promise<void> {
    // ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼
    const auth = new google.auth.GoogleAuth({
      keyFile: process.env.GOOGLE_SERVICE_ACCOUNT_KEY,
      scopes: ['https://www.googleapis.com/auth/spreadsheets.readonly']
    });
    
    this.sheetsClient = google.sheets({ version: 'v4', auth });
  }

  // Supabaseèªè¨¼
  async authenticateSupabase(): Promise<void> {
    // ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ãƒ¼ãƒ«ã‚­ãƒ¼ã‚’ä½¿ç”¨
    this.supabase = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_ROLE_KEY
    );
  }
}
```

### ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼

```typescript
class DataValidator {
  // ç‰©ä»¶ç•ªå·ã®æ¤œè¨¼
  validatePropertyNumber(propertyNumber: string): boolean {
    // AA + 4æ¡ã®æ•°å­—
    return /^AA\d{4,5}$/.test(propertyNumber);
  }

  // ATBBçŠ¶æ³ã®æ¤œè¨¼
  validateAtbbStatus(status: string): boolean {
    const validStatuses = [
      'å…¬é–‹ä¸­',
      'éå…¬é–‹',
      'å…¬é–‹æº–å‚™ä¸­',
      'å…¬é–‹åœæ­¢'
    ];
    
    return validStatuses.includes(status);
  }

  // ä¾¡æ ¼ã®æ¤œè¨¼
  validatePrice(price: number): boolean {
    return price > 0 && price < 1000000000; // 10å„„å††æœªæº€
  }
}
```


## ãƒ†ã‚¹ãƒˆè¨­è¨ˆ

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

```typescript
describe('PropertyListingSyncService', () => {
  describe('detectChanges', () => {
    it('should detect ATBB status change', () => {
      const sheetData = [{
        property_number: 'AA4885',
        atbb_status: 'å…¬é–‹ä¸­'
      }];
      
      const dbData = [{
        property_number: 'AA4885',
        atbb_status: 'éå…¬é–‹'
      }];
      
      const changes = service.detectChanges(sheetData, dbData);
      
      expect(changes).toHaveLength(1);
      expect(changes[0].fields[0].field).toBe('atbb_status');
      expect(changes[0].fields[0].newValue).toBe('å…¬é–‹ä¸­');
    });

    it('should not detect changes when data is same', () => {
      const sheetData = [{
        property_number: 'AA4885',
        atbb_status: 'å…¬é–‹ä¸­'
      }];
      
      const dbData = [{
        property_number: 'AA4885',
        atbb_status: 'å…¬é–‹ä¸­'
      }];
      
      const changes = service.detectChanges(sheetData, dbData);
      
      expect(changes).toHaveLength(0);
    });

    it('should skip new properties', () => {
      const sheetData = [{
        property_number: 'AA9999',
        atbb_status: 'å…¬é–‹ä¸­'
      }];
      
      const dbData = []; // æ–°è¦ç‰©ä»¶
      
      const changes = service.detectChanges(sheetData, dbData);
      
      expect(changes).toHaveLength(0);
    });
  });

  describe('compareFields', () => {
    it('should detect multiple field changes', () => {
      const sheetRow = {
        property_number: 'AA4885',
        atbb_status: 'å…¬é–‹ä¸­',
        price: 50000000
      };
      
      const dbRow = {
        property_number: 'AA4885',
        atbb_status: 'éå…¬é–‹',
        price: 48000000
      };
      
      const changes = service.compareFields(sheetRow, dbRow);
      
      expect(changes).toHaveLength(2);
      expect(changes.map(c => c.field)).toContain('atbb_status');
      expect(changes.map(c => c.field)).toContain('price');
    });
  });
});
```

### çµ±åˆãƒ†ã‚¹ãƒˆ

```typescript
describe('Property Listing Update Sync Integration', () => {
  beforeEach(async () => {
    // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    await setupTestData();
  });

  afterEach(async () => {
    // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
    await cleanupTestData();
  });

  it('should sync updated property from spreadsheet to database', async () => {
    // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§AA4885ã‚’æ›´æ–°
    await updateSpreadsheet('AA4885', {
      atbb_status: 'å…¬é–‹ä¸­'
    });
    
    // åŒæœŸå®Ÿè¡Œ
    const result = await syncService.syncUpdatedPropertyListings();
    
    // çµæœæ¤œè¨¼
    expect(result.updated).toBeGreaterThan(0);
    expect(result.errors).toHaveLength(0);
    
    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª
    const property = await fetchProperty('AA4885');
    expect(property.atbb_status).toBe('å…¬é–‹ä¸­');
  });

  it('should handle sync errors gracefully', async () => {
    // ç„¡åŠ¹ãªãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
    await updateSpreadsheet('AA4885', {
      price: -1000 // ç„¡åŠ¹ãªä¾¡æ ¼
    });
    
    // åŒæœŸå®Ÿè¡Œ
    const result = await syncService.syncUpdatedPropertyListings();
    
    // ã‚¨ãƒ©ãƒ¼ãŒè¨˜éŒ²ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    expect(result.errors.length).toBeGreaterThan(0);
    expect(result.errors[0].propertyNumber).toBe('AA4885');
  });
});
```

### E2Eãƒ†ã‚¹ãƒˆ

```typescript
describe('End-to-End Sync Test', () => {
  it('should complete full sync cycle', async () => {
    // 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
    const server = await startServer();
    
    // 2. 5ç§’å¾…æ©Ÿï¼ˆåˆå›åŒæœŸï¼‰
    await delay(5000);
    
    // 3. sync_logsãƒ†ãƒ¼ãƒ–ãƒ«ç¢ºèª
    const logs = await fetchSyncLogs();
    expect(logs.length).toBeGreaterThan(0);
    
    // 4. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ›´æ–°
    await updateSpreadsheet('AA4885', {
      atbb_status: 'å…¬é–‹ä¸­'
    });
    
    // 5. 5åˆ†å¾…æ©Ÿï¼ˆå®šæœŸåŒæœŸï¼‰
    await delay(5 * 60 * 1000);
    
    // 6. æ›´æ–°ç¢ºèª
    const property = await fetchProperty('AA4885');
    expect(property.atbb_status).toBe('å…¬é–‹ä¸­');
    
    // 7. ã‚µãƒ¼ãƒãƒ¼åœæ­¢
    await stopServer(server);
  });
});
```

## ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­è¨ˆ

### ç’°å¢ƒå¤‰æ•°

```bash
# Google Sheets API
GOOGLE_SERVICE_ACCOUNT_KEY=/path/to/service-account.json
SPREADSHEET_ID=your-spreadsheet-id

# Supabase
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# è‡ªå‹•åŒæœŸè¨­å®š
AUTO_SYNC_ENABLED=true
SYNC_INTERVAL_MINUTES=5

# ãƒ­ã‚°è¨­å®š
LOG_LEVEL=INFO
LOG_FILE=/path/to/sync.log
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæ‰‹é †

```bash
# 1. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
cp backend/.env.example backend/.env
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†

# 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cd backend
npm install

# 3. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
npx ts-node migrations/run-039-migration.ts

# 4. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# 5. èµ·å‹•ç¢ºèª
# ãƒ­ã‚°ã§ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª:
# âœ… EnhancedAutoSyncService initialized
# ğŸ“Š Enhanced periodic auto-sync enabled

# 6. åˆå›åŒæœŸç¢ºèªï¼ˆ5ç§’å¾Œï¼‰
# ãƒ­ã‚°ã§åŒæœŸå®Ÿè¡Œã‚’ç¢ºèª

# 7. å®šæœŸåŒæœŸç¢ºèªï¼ˆ5åˆ†å¾Œï¼‰
# ãƒ­ã‚°ã§2å›ç›®ã®åŒæœŸå®Ÿè¡Œã‚’ç¢ºèª
```

### ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †

```bash
# 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼åœæ­¢
# Ctrl+C ã¾ãŸã¯ taskkill

# 2. ç’°å¢ƒå¤‰æ•°ã‚’ç„¡åŠ¹åŒ–
# .envãƒ•ã‚¡ã‚¤ãƒ«ã§ AUTO_SYNC_ENABLED=false

# 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒï¼ˆå¿…è¦ãªå ´åˆï¼‰
# Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰å¾©å…ƒ

# 4. ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•
npm run dev
```

## é‹ç”¨è¨­è¨ˆ

### æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

```markdown
## æ¯æ—¥ã®ç¢ºèªäº‹é …

- [ ] sync_logsãƒ†ãƒ¼ãƒ–ãƒ«ã§æœ€æ–°ã®åŒæœŸæ™‚åˆ»ã‚’ç¢ºèª
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãŒãªã„ã‹ç¢ºèª
- [ ] åŒæœŸå‡¦ç†ã®å®Ÿè¡Œæ™‚é–“ã‚’ç¢ºèªï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ï¼‰
- [ ] ä¸»è¦ç‰©ä»¶ï¼ˆAA4885ç­‰ï¼‰ã®æ›´æ–°çŠ¶æ…‹ã‚’ç¢ºèª
```

### é€±æ¬¡ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

```markdown
## æ¯é€±ã®ç¢ºèªäº‹é …

- [ ] sync_logsãƒ†ãƒ¼ãƒ–ãƒ«ã®è‚¥å¤§åŒ–ãƒã‚§ãƒƒã‚¯
- [ ] ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç‡ã®åˆ†æ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åˆ†æ
- [ ] ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç¢ºèª
```

### ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

```typescript
class AlertService {
  // ã‚¨ãƒ©ãƒ¼ç‡ãŒé«˜ã„å ´åˆã«ã‚¢ãƒ©ãƒ¼ãƒˆ
  async checkErrorRate(): Promise<void> {
    const recentLogs = await this.fetchRecentLogs(24); // 24æ™‚é–“
    const errorRate = this.calculateErrorRate(recentLogs);
    
    if (errorRate > 0.1) { // 10%ä»¥ä¸Š
      await this.sendAlert({
        level: 'WARNING',
        message: `High error rate detected: ${errorRate * 100}%`
      });
    }
  }

  // åŒæœŸãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„å ´åˆã«ã‚¢ãƒ©ãƒ¼ãƒˆ
  async checkSyncFrequency(): Promise<void> {
    const lastSync = await this.getLastSyncTime();
    const timeSinceLastSync = Date.now() - lastSync.getTime();
    
    if (timeSinceLastSync > 10 * 60 * 1000) { // 10åˆ†ä»¥ä¸Š
      await this.sendAlert({
        level: 'ERROR',
        message: 'Sync has not run for 10 minutes'
      });
    }
  }
}
```


## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­è¨ˆ

### å•é¡Œè¨ºæ–­ãƒ•ãƒ­ãƒ¼

```
åŒæœŸãŒå‹•ä½œã—ãªã„
    â”‚
    â”œâ”€ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã¯èµ·å‹•ã—ã¦ã„ã‚‹ï¼Ÿ
    â”‚   NO â†’ ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
    â”‚   YES â†“
    â”‚
    â”œâ”€ èµ·å‹•ãƒ­ã‚°ã«ã€ŒEnhanced periodic auto-sync enabledã€ãŒã‚ã‚‹ï¼Ÿ
    â”‚   NO â†’ ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèªï¼ˆAUTO_SYNC_ENABLED=trueï¼‰
    â”‚   YES â†“
    â”‚
    â”œâ”€ sync_logsãƒ†ãƒ¼ãƒ–ãƒ«ã«è¨˜éŒ²ãŒã‚ã‚‹ï¼Ÿ
    â”‚   NO â†’ åˆå›åŒæœŸãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„
    â”‚        â†’ ãƒ­ã‚°ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
    â”‚   YES â†“
    â”‚
    â”œâ”€ æœ€æ–°ã®åŒæœŸæ™‚åˆ»ã¯5åˆ†ä»¥å†…ï¼Ÿ
    â”‚   NO â†’ å®šæœŸåŒæœŸãŒåœæ­¢ã—ã¦ã„ã‚‹
    â”‚        â†’ ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•
    â”‚   YES â†“
    â”‚
    â””â”€ æ›´æ–°ãŒåæ˜ ã•ã‚Œãªã„
        â†’ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
        â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
        â†’ å·®åˆ†æ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯ã‚’ç¢ºèª
```

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### å•é¡Œ1: åŒæœŸãŒä¸€åº¦ã‚‚å®Ÿè¡Œã•ã‚Œãªã„

**ç—‡çŠ¶**:
- sync_logsãƒ†ãƒ¼ãƒ–ãƒ«ã«è¨˜éŒ²ãŒãªã„
- ãƒ­ã‚°ã«åŒæœŸå®Ÿè¡Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãªã„

**åŸå› **:
- ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„
- å®šæœŸåŒæœŸãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒèµ·å‹•ã—ã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
cat backend/.env | grep AUTO_SYNC

# 2. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šï¼ˆå¿…è¦ãªå ´åˆï¼‰
echo "AUTO_SYNC_ENABLED=true" >> backend/.env
echo "SYNC_INTERVAL_MINUTES=5" >> backend/.env

# 3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•
cd backend
npm run dev
```

#### å•é¡Œ2: æ›´æ–°ãŒåæ˜ ã•ã‚Œãªã„

**ç—‡çŠ¶**:
- åŒæœŸã¯å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹
- ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§å¤‰æ›´ã—ãŸãŒã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åæ˜ ã•ã‚Œãªã„

**åŸå› **:
- å·®åˆ†æ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ãªã„
- ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°ãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. æ‰‹å‹•åŒæœŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ç¢ºèª
npx ts-node backend/sync-property-listings-updates.ts

# 2. è©³ç´°ãƒ­ã‚°ã‚’ç¢ºèª
# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’DEBUGã«å¤‰æ›´
export LOG_LEVEL=DEBUG

# 3. ç‰¹å®šã®ç‰©ä»¶ã‚’è¨ºæ–­
npx ts-node backend/diagnose-property-sync.ts AA4885
```

#### å•é¡Œ3: ã‚¨ãƒ©ãƒ¼ãŒé »ç™ºã™ã‚‹

**ç—‡çŠ¶**:
- sync_logsã«ã‚¨ãƒ©ãƒ¼ãŒå¤šæ•°è¨˜éŒ²ã•ã‚Œã‚‹
- ä¸€éƒ¨ã®ç‰©ä»¶ãŒæ›´æ–°ã•ã‚Œãªã„

**åŸå› **:
- ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚¨ãƒ©ãƒ¼
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼
- APIåˆ¶é™ã‚¨ãƒ©ãƒ¼

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª
npx ts-node backend/check-sync-errors.ts

# 2. ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã‚’åˆ†æ
# - VALIDATION_ERROR â†’ ãƒ‡ãƒ¼ã‚¿ã‚’ä¿®æ­£
# - NETWORK_ERROR â†’ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç¢ºèª
# - RATE_LIMIT_ERROR â†’ åŒæœŸé–“éš”ã‚’å»¶é•·

# 3. åŒæœŸé–“éš”ã‚’å»¶é•·ï¼ˆå¿…è¦ãªå ´åˆï¼‰
# .envãƒ•ã‚¡ã‚¤ãƒ«ã§ SYNC_INTERVAL_MINUTES=10
```

#### å•é¡Œ4: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒä½ä¸‹ã™ã‚‹

**ç—‡çŠ¶**:
- åŒæœŸå‡¦ç†ã«æ™‚é–“ãŒã‹ã‹ã‚‹
- ã‚µãƒ¼ãƒãƒ¼ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒå¢—åŠ 

**åŸå› **:
- ç‰©ä»¶æ•°ãŒå¢—åŠ 
- æœ€é©åŒ–ãŒä¸ååˆ†

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç¢ºèª
npx ts-node backend/check-sync-performance.ts

# 2. æœ€é©åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–
# .envãƒ•ã‚¡ã‚¤ãƒ«ã§ SYNC_OPTIMIZATION=true

# 3. ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’èª¿æ•´
# .envãƒ•ã‚¡ã‚¤ãƒ«ã§ SYNC_BATCH_SIZE=50
```

### è¨ºæ–­ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```typescript
// backend/diagnose-sync-status.ts
async function diagnoseSyncStatus() {
  console.log('ğŸ” åŒæœŸçŠ¶æ…‹è¨ºæ–­é–‹å§‹...\n');

  // 1. ç’°å¢ƒå¤‰æ•°ç¢ºèª
  console.log('ğŸ“‹ ç’°å¢ƒå¤‰æ•°:');
  console.log(`  AUTO_SYNC_ENABLED: ${process.env.AUTO_SYNC_ENABLED}`);
  console.log(`  SYNC_INTERVAL_MINUTES: ${process.env.SYNC_INTERVAL_MINUTES}\n`);

  // 2. sync_logsãƒ†ãƒ¼ãƒ–ãƒ«ç¢ºèª
  console.log('ğŸ“Š sync_logsãƒ†ãƒ¼ãƒ–ãƒ«:');
  const logs = await fetchRecentSyncLogs(10);
  console.log(`  æœ€æ–°ã®åŒæœŸ: ${logs[0]?.started_at || 'ãªã—'}`);
  console.log(`  è¨˜éŒ²ä»¶æ•°: ${logs.length}\n`);

  // 3. æœ€æ–°ã®åŒæœŸçµæœ
  if (logs.length > 0) {
    const latest = logs[0];
    console.log('âœ… æœ€æ–°ã®åŒæœŸçµæœ:');
    console.log(`  ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${latest.status}`);
    console.log(`  æ›´æ–°ä»¶æ•°: ${latest.records_processed}`);
    console.log(`  å®Ÿè¡Œæ™‚é–“: ${latest.duration_ms}ms\n`);
  }

  // 4. AA4885ã®çŠ¶æ…‹ç¢ºèª
  console.log('ğŸ  AA4885ã®çŠ¶æ…‹:');
  const property = await fetchProperty('AA4885');
  console.log(`  ATBBçŠ¶æ³: ${property.atbb_status}`);
  console.log(`  æœ€çµ‚åŒæœŸ: ${property.last_synced_at}\n`);

  // 5. æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  console.log('ğŸ’¡ æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:');
  if (logs.length === 0) {
    console.log('  âš ï¸ åŒæœŸãŒä¸€åº¦ã‚‚å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“');
    console.log('  â†’ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„');
  } else if (isOlderThan(logs[0].started_at, 10)) {
    console.log('  âš ï¸ æœ€æ–°ã®åŒæœŸãŒ10åˆ†ä»¥ä¸Šå‰ã§ã™');
    console.log('  â†’ å®šæœŸåŒæœŸãŒåœæ­¢ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™');
  } else {
    console.log('  âœ… åŒæœŸã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™');
  }
}
```

## å°†æ¥ã®æ”¹å–„æ¡ˆ

### Phase 2: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ

**æ¦‚è¦**: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®å¤‰æ›´ã‚’å³åº§ã«æ¤œçŸ¥ã—ã¦åŒæœŸ

**æŠ€è¡“**:
- Google Sheets API Webhooks
- Server-Sent Events (SSE)
- WebSocket

**ãƒ¡ãƒªãƒƒãƒˆ**:
- åŒæœŸé…å»¶ã®å‰Šæ¸›ï¼ˆ5åˆ† â†’ æ•°ç§’ï¼‰
- ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã®å‰Šæ¸›

### Phase 3: åŒæœŸçŠ¶æ…‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

**æ¦‚è¦**: åŒæœŸçŠ¶æ…‹ã‚’å¯è¦–åŒ–ã™ã‚‹Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

**æ©Ÿèƒ½**:
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸçŠ¶æ…‹è¡¨ç¤º
- åŒæœŸå±¥æ­´ã®ã‚°ãƒ©ãƒ•è¡¨ç¤º
- ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å¯è¦–åŒ–

### Phase 4: è‡ªå‹•ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½

**æ¦‚è¦**: å•é¡Œç™ºç”Ÿæ™‚ã«è‡ªå‹•çš„ã«é€šçŸ¥

**é€šçŸ¥æ–¹æ³•**:
- ãƒ¡ãƒ¼ãƒ«é€šçŸ¥
- Slacké€šçŸ¥
- SMSé€šçŸ¥ï¼ˆç·Šæ€¥æ™‚ï¼‰

**ã‚¢ãƒ©ãƒ¼ãƒˆæ¡ä»¶**:
- ã‚¨ãƒ©ãƒ¼ç‡ãŒ10%ã‚’è¶…ãˆã‚‹
- åŒæœŸãŒ10åˆ†ä»¥ä¸Šå®Ÿè¡Œã•ã‚Œãªã„
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒåŸºæº–å€¤ã‚’ä¸‹å›ã‚‹

### Phase 5: åŒæ–¹å‘åŒæœŸ

**æ¦‚è¦**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®åŒæœŸã‚‚å®Ÿè£…

**ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**:
- ã‚·ã‚¹ãƒ†ãƒ å†…ã§æ›´æ–°ã—ãŸæƒ…å ±ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«åæ˜ 
- ãƒ‡ãƒ¼ã‚¿ã®ä¸€å…ƒç®¡ç†

**èª²é¡Œ**:
- ç«¶åˆè§£æ±ºã®ä»•çµ„ã¿ãŒå¿…è¦
- ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ä¿è¨¼

## ã¾ã¨ã‚

### è¨­è¨ˆã®è¦ç‚¹

1. **ã‚·ãƒ³ãƒ—ãƒ«ãªä¿®æ­£**: æ—¢å­˜ã®å®Ÿè£…ã‚’æ´»ç”¨ã—ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã®å†èµ·å‹•ã§è§£æ±º
2. **å …ç‰¢ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ã¨è©³ç´°ãªãƒ­ã‚°è¨˜éŒ²
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: å·®åˆ†æ¤œå‡ºã¨ãƒãƒƒãƒæ›´æ–°
4. **é‹ç”¨ã—ã‚„ã™ã•**: è¨ºæ–­ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨è©³ç´°ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
5. **æ‹¡å¼µæ€§**: å°†æ¥ã®æ”¹å–„ã«å¯¾å¿œã§ãã‚‹è¨­è¨ˆ

### æˆåŠŸã®éµ

- ç’°å¢ƒå¤‰æ•°ã®æ­£ã—ã„è¨­å®š
- å®šæœŸåŒæœŸãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®ç¢ºå®Ÿãªèµ·å‹•
- ç¶™ç¶šçš„ãªç›£è¦–ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
- å•é¡Œç™ºç”Ÿæ™‚ã®è¿…é€Ÿãªå¯¾å¿œ

---

**ä½œæˆæ—¥**: 2025-01-11  
**æœ€çµ‚æ›´æ–°**: 2025-01-11  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¨­è¨ˆå®Œäº† â†’ å®Ÿè£…é–‹å§‹å¯èƒ½

