# Implementation Plan

- [x] 1. フロントエンド: BuyerTableコンポーネントの作成
  - BuyerTable.tsxコンポーネントを新規作成
  - 買主リストをテーブル形式で表示
  - テーブル列: 買主番号、氏名、確度、ステータス、受付日、次電日、連絡先
  - 買主データの取得ロジックを実装
  - ローディング状態と空状態の表示
  - エラーハンドリングと再試行機能
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 6.1, 6.3, 6.4_

- [x] 2. フロントエンド: BuyerTableのスタイリングと視覚効果
  - 高確度買主（A/Sランク）の確度バッジを赤色でハイライト
  - 次電日がある場合は目立つ色で表示
  - 買主行のホバー効果を実装
  - 日付フォーマット（YYYY/MM/DD）を実装
  - テーブルのスクロール機能を実装（maxHeight設定）
  - _Requirements: 4.1, 4.2, 4.3, 4.4, 8.1, 8.2, 8.3, 8.4_

- [x] 3. フロントエンド: 買主行クリックで詳細ページへの遷移
  - 買主行クリックハンドラーを実装
  - useNavigateを使用して買主詳細ページに遷移
  - 遷移時にモーダルを閉じる処理を実装
  - _Requirements: 3.1, 3.2, 3.3, 3.4_

- [x] 4. フロントエンド: 連絡先リンクの実装
  - 電話番号をtel:リンクとして表示
  - メールアドレスをmailto:リンクとして表示
  - 連絡先クリック時に行クリックイベントを防ぐ（stopPropagation）
  - 連絡先が未登録の場合は「未登録」と表示
  - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 5. フロントエンド: PropertyListingDetailModalに買主タブを追加
  - tabLabelsに「買主」を追加
  - 買主タブのラベルに件数を表示（例: "買主 (3)"）
  - 買主タブの状態管理を実装（buyers, loading, error, loaded）
  - タブ切り替え時の処理を実装
  - 買主タブが初めて選択されたときのみデータを取得（遅延ロード）
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 6.1, 6.2_

- [x] 6. フロントエンド: 買主タブにBuyerTableコンポーネントを統合
  - PropertyListingDetailModal内で買主タブが選択されたときにBuyerTableを表示
  - propertyNumberをBuyerTableに渡す
  - BuyerTableからのナビゲーション時にモーダルを閉じる処理を実装
  - _Requirements: 1.4, 3.3_

- [x] 7. フロントエンド: 「売主・買主」タブを「売主」タブに変更
  - tabLabelsの「売主・買主」を「売主」に変更
  - PartyInfoSectionをSellerInfoSectionに変更
  - 買主情報セクションを削除（売主情報のみ表示）
  - _Requirements: 7.1, 7.2, 7.3_

- [x] 8. フロントエンド: モーダルを閉じたときの状態リセット
  - モーダルを閉じたときに買主タブの状態をリセット
  - 次回モーダルを開いたときに新しいデータを取得できるようにする
  - _Requirements: 6.2_

- [x] 9. フロントエンド: 買主タブに「新規作成」ボタンを追加
  - 買主タブの上部に「新規作成」ボタンを配置
  - ボタンクリック時に買主作成ページに遷移
  - 遷移時にpropertyNumberをURLパラメータとして渡す
  - 遷移時にモーダルを閉じる処理を実装
  - _Requirements: 9.1, 9.2, 9.3, 9.6_

- [x] 10. フロントエンド: NewBuyerPageでURLパラメータから物件番号を取得
  - useSearchParamsを使用してURLパラメータからpropertyNumberを取得
  - 取得したpropertyNumberをformDataのproperty_numberフィールドに設定
  - propertyNumberが存在する場合は物件情報を取得
  - _Requirements: 9.3, 9.4_

- [x] 11. フロントエンド: NewBuyerPageに物件情報の参照表示を追加
  - 物件番号が入力されている場合、物件情報を取得するAPIを呼び出す
  - 取得した物件情報（住所、物件種別、価格）を参照情報として表示
  - 参照情報は読み取り専用のPaperコンポーネントで表示
  - 物件情報の取得に失敗した場合はエラーを表示しない（無視）
  - _Requirements: 9.5_

- [x] 12. バックエンド: 買主作成APIの実装
  - BuyerService.create()メソッドを実装
  - 買主番号の自動生成機能を実装（最新番号+1）
  - POST /api/buyersエンドポイントを実装
  - 基本的なバリデーション（name必須）を実装
  - 201ステータスで作成された買主データを返却
  - _Requirements: 9.4_

- [x] 13. 統合テストとマニュアルテスト
  - 物件詳細モーダルで買主タブの表示を確認
  - 買主リストのテーブル表示を確認
  - 高確度買主のハイライト表示を確認
  - 買主行クリックで買主詳細ページへの遷移を確認
  - 連絡先リンクの動作を確認
  - 空状態の表示を確認
  - エラー状態の表示を確認
  - 「売主」タブの表示を確認
  - 「新規作成」ボタンの表示を確認
  - 「新規作成」ボタンクリックで買主作成ページへの遷移を確認
  - 買主作成ページで物件番号が事前入力されていることを確認
  - 買主作成ページで物件情報が参照表示されることを確認
  - _Requirements: All_
