# 公開物件サイト「公開中のみ表示」デフォルト設定変更

## 概要

公開物件サイトの「公開中のみ表示」フィルターが現在デフォルトで有効（true）になっていますが、これをデフォルトで無効（false）に変更します。

## 背景

- **現在の動作**: ページを開くと「公開中のみ表示」が自動的にONになっている
- **問題点**: ユーザーが全ての物件を見たい場合、毎回手動でフィルターを解除する必要がある
- **要望**: デフォルトで全ての物件を表示し、必要に応じてユーザーが「公開中のみ表示」を選択できるようにする

## 現在の実装

### ファイル
`frontend/src/pages/PublicPropertiesPage.tsx`

### 該当コード（69行目）
```typescript
// 公開中のみ表示フィルター状態（デフォルトで公開物件のみ表示）
const [showPublicOnly, setShowPublicOnly] = useState<boolean>(true);
```

### 関連する動作
1. **初期表示**: `showPublicOnly`が`true`のため、公開中の物件のみが表示される
2. **URLパラメータ**: `showPublicOnly=true`がURLに自動的に追加される（341行目）
3. **ボタン表示**: ボタンに「✓ 公開中のみ表示」と表示される（866行目）
4. **APIリクエスト**: `showPublicOnly=true`パラメータがバックエンドに送信される

## 要件

### 1. ユーザーストーリー

**As a** 公開物件サイトの訪問者  
**I want** デフォルトで全ての物件を見たい  
**So that** 公開中・公開前・非公開などの状態に関わらず、全ての物件情報を確認できる

### 2. 受け入れ基準

#### 2.1 初期表示
- [ ] ページを開いた時、`showPublicOnly`が`false`である
- [ ] 全ての物件（公開中、公開前、非公開など）が表示される
- [ ] 「公開中のみ表示」ボタンがOFF状態（チェックマークなし）で表示される

#### 2.2 URLパラメータ
- [ ] 初期表示時、URLに`showPublicOnly`パラメータが含まれない
- [ ] ユーザーが「公開中のみ表示」ボタンをクリックした時のみ、`showPublicOnly=true`がURLに追加される

#### 2.3 フィルター動作
- [ ] 「公開中のみ表示」ボタンをクリックすると、公開中の物件のみが表示される
- [ ] もう一度クリックすると、全ての物件が表示される（元の状態に戻る）

#### 2.4 状態復元
- [ ] 詳細画面から戻ってきた時、フィルター状態が正しく復元される
- [ ] URLパラメータから状態を復元する際、`showPublicOnly`パラメータがない場合は`false`として扱う

#### 2.5 「すべての条件をクリア」ボタン
- [ ] 「すべての条件をクリア」ボタンをクリックした時、`showPublicOnly`が`false`になる（現在の動作を維持）

### 3. 非機能要件

#### 3.1 パフォーマンス
- [ ] 初期表示時のデータ取得速度に影響がない
- [ ] フィルター切り替え時のレスポンスが1秒以内

#### 3.2 互換性
- [ ] 既存のURLパラメータ（`showPublicOnly=true`）が含まれている場合、正しく動作する
- [ ] 他のフィルター（物件タイプ、価格、築年数など）との組み合わせが正しく動作する

#### 3.3 ユーザビリティ
- [ ] ボタンの表示が直感的である（ON/OFF状態が明確）
- [ ] フィルター変更時のローディング表示が適切

## 影響範囲

### 変更が必要なファイル
1. `frontend/src/pages/PublicPropertiesPage.tsx`
   - 69行目: `useState<boolean>(true)` → `useState<boolean>(false)`

### 変更が不要なファイル
- バックエンドAPI: 変更不要（`showPublicOnly`パラメータの有無で動作が変わる）
- 他のコンポーネント: 変更不要

## テストケース

### ケース1: 初期表示
1. 公開物件サイトを開く
2. **期待結果**: 全ての物件が表示される
3. **期待結果**: 「公開中のみ表示」ボタンがOFF状態

### ケース2: フィルター有効化
1. 「公開中のみ表示」ボタンをクリック
2. **期待結果**: 公開中の物件のみが表示される
3. **期待結果**: ボタンに「✓ 公開中のみ表示」と表示される
4. **期待結果**: URLに`showPublicOnly=true`が追加される

### ケース3: フィルター無効化
1. 「公開中のみ表示」ボタンがON状態の時、もう一度クリック
2. **期待結果**: 全ての物件が表示される
3. **期待結果**: ボタンがOFF状態に戻る
4. **期待結果**: URLから`showPublicOnly`パラメータが削除される

### ケース4: URLパラメータからの復元
1. `?showPublicOnly=true`を含むURLでアクセス
2. **期待結果**: 公開中の物件のみが表示される
3. **期待結果**: ボタンがON状態

### ケース5: 詳細画面からの戻り
1. フィルターをOFFの状態で物件詳細を開く
2. ブラウザの戻るボタンで一覧に戻る
3. **期待結果**: フィルターがOFF状態のまま
4. **期待結果**: 全ての物件が表示される

### ケース6: 他のフィルターとの組み合わせ
1. 物件タイプ「マンション」を選択
2. 「公開中のみ表示」をON
3. **期待結果**: 公開中のマンションのみが表示される
4. 「公開中のみ表示」をOFF
5. **期待結果**: 全てのマンションが表示される

## リスク

### 低リスク
- **変更箇所が1行のみ**: `true` → `false`の変更のみ
- **既存の動作を壊さない**: フィルター機能自体は変更しない
- **ロールバックが容易**: 問題があれば即座に元に戻せる

### 考慮事項
- **ユーザーの期待**: 一部のユーザーは「公開中のみ表示」がデフォルトであることを期待している可能性がある
  - **対策**: 変更後も「公開中のみ表示」ボタンは目立つ位置に配置されているため、必要に応じて簡単に有効化できる

## 実装の優先度

**優先度**: 高

**理由**:
- 変更が簡単（1行のみ）
- ユーザビリティの向上
- 本番環境で使用中のため、早急な対応が望ましい

## 関連ドキュメント

- 公開物件サイト: `https://property-site-frontend-kappa.vercel.app/public/properties`
- フロントエンドコード: `frontend/src/pages/PublicPropertiesPage.tsx`

## 承認

- [ ] 要件レビュー完了
- [ ] 設計レビュー完了
- [ ] 実装準備完了
