# スプレッドシート調査 - タスク一覧

## Phase 1: スクリプト作成と実行

### Task 1.1: シート名取得スクリプト作成 ✅

**説明:** スプレッドシート内の全シート名を取得するスクリプトを作成する

**受入基準:**
- [x] `backend/list-property-listing-sheets.ts` を作成
- [x] Google Sheets API を使用してシート名を取得
- [x] 各シートの情報（ID、インデックス、行数、列数）を表示
- [x] エラーハンドリングを実装

**担当:** 開発者  
**優先度:** High  
**見積もり:** 30分  
**ステータス:** 完了

---

### Task 1.2: スクリプト実行

**説明:** 作成したスクリプトを実行し、シート名一覧を取得する

**受入基準:**
- [ ] スクリプトを実行
- [ ] 出力結果を確認
- [ ] 全シート名が正しく取得できることを確認

**担当:** 開発者  
**優先度:** High  
**見積もり:** 10分  
**ステータス:** 未着手

**実行コマンド:**
```bash
cd backend
npx ts-node list-property-listing-sheets.ts
```

---

## Phase 2: シート名特定と設定修正

### Task 2.1: 正しいシート名の特定

**説明:** 出力結果から物件リストに該当するシート名を特定する

**受入基準:**
- [ ] 出力結果を分析
- [ ] 物件リストに該当するシート名を特定
- [ ] シート名をドキュメントに記録

**担当:** 開発者  
**優先度:** High  
**見積もり:** 10分  
**ステータス:** 未着手

**確認ポイント:**
- シート名に「物件」「リスト」「業務」などのキーワードが含まれているか
- 行数・列数が物件リストとして妥当か
- 他のシートとの違いは何か

---

### Task 2.2: 設定ファイルの修正

**説明:** 特定したシート名を設定ファイルに反映する

**受入基準:**
- [ ] `backend/src/services/PropertyListingSyncService.ts` のシート名を修正
- [ ] `backend/src/config/property-listing-column-mapping.json` のシート名を修正（該当する場合）
- [ ] その他、シート名を参照している箇所を修正

**担当:** 開発者  
**優先度:** High  
**見積もり:** 20分  
**ステータス:** 未着手

**修正対象ファイル:**
1. `backend/src/services/PropertyListingSyncService.ts`
2. `backend/src/config/property-listing-column-mapping.json`
3. その他、シート名をハードコードしている箇所

---

### Task 2.3: 動作確認

**説明:** 設定修正後、スプレッドシート同期機能が正常に動作することを確認する

**受入基準:**
- [ ] スプレッドシート同期スクリプトを実行
- [ ] エラーが発生しないことを確認
- [ ] データが正しく取得できることを確認

**担当:** 開発者  
**優先度:** High  
**見積もり:** 15分  
**ステータス:** 未着手

**確認コマンド:**
```bash
cd backend
npx ts-node sync-property-listings.ts
```

---

## Phase 3: ドキュメント更新

### Task 3.1: 調査結果のドキュメント化

**説明:** 調査結果をドキュメントにまとめる

**受入基準:**
- [ ] 特定したシート名を記録
- [ ] 各シートの用途を記録
- [ ] 今後の参考情報として保存

**担当:** 開発者  
**優先度:** Medium  
**見積もり:** 15分  
**ステータス:** 未着手

**ドキュメント作成先:**
- `.kiro/specs/spreadsheet-investigation/INVESTIGATION_RESULTS.md`

---

## 進捗サマリー

| Phase | タスク数 | 完了 | 進行中 | 未着手 |
|-------|---------|------|--------|--------|
| Phase 1 | 2 | 1 | 0 | 1 |
| Phase 2 | 3 | 0 | 0 | 3 |
| Phase 3 | 1 | 0 | 0 | 1 |
| **合計** | **6** | **1** | **0** | **5** |

## 次のアクション

1. **今すぐ実行:** Task 1.2 - スクリプトを実行してシート名を取得
2. **その後:** Task 2.1 - 正しいシート名を特定
3. **最後に:** Task 2.2 - 設定ファイルを修正して動作確認
