# スプレッドシート調査 - 要件定義書

## 概要

売主リスト管理システムで使用しているGoogleスプレッドシートの構造を調査し、正しいシート名を特定するための調査タスクです。

## 背景

現在、スプレッドシート同期機能で「物件リスト」というシート名を使用していますが、エラーメッセージから実際のシート名が異なる可能性があります。正確なシート名を特定する必要があります。

## 目的

1. スプレッドシート内の全シート名を取得する
2. 各シートの構造（列名、データ件数）を確認する
3. 正しいシート名を特定し、設定を修正する

## 要件

### 要件1: シート名一覧取得

**ユーザーストーリー:** 開発者として、スプレッドシートの全シート名を確認したいので、シート名一覧を取得するスクリプトを実行できるようにしたい

#### 受入基準

1. WHEN スクリプトを実行した場合、システムはスプレッドシート内の全シート名を取得しなければならない
2. WHEN シート名を取得した場合、システムは各シート名をコンソールに出力しなければならない
3. WHEN シート名を取得した場合、システムは各シートのインデックス番号も表示しなければならない
4. WHEN エラーが発生した場合、システムは詳細なエラーメッセージを表示しなければならない

### 要件2: シート構造確認

**ユーザーストーリー:** 開発者として、各シートの構造を確認したいので、列名とデータ件数を取得できるようにしたい

#### 受入基準

1. WHEN シート構造を確認する場合、システムは各シートの1行目（ヘッダー行）を取得しなければならない
2. WHEN シート構造を確認する場合、システムは各シートのデータ行数を取得しなければならない
3. WHEN シート構造を表示する場合、システムは見やすい形式で出力しなければならない

## 技術仕様

### 使用するAPI

- Google Sheets API v4
- 認証: サービスアカウント（既存の設定を使用）

### 出力形式

```
スプレッドシート内のシート一覧:
----------------------------------------
[0] シート名1
[1] シート名2
[2] シート名3
...
```

## 実装計画

### Phase 1: シート名取得スクリプト作成

1. `backend/list-property-listing-sheets.ts` を作成
2. Google Sheets APIを使用してシート名を取得
3. コンソールに出力

### Phase 2: 実行と確認

1. スクリプトを実行
2. 出力結果を確認
3. 正しいシート名を特定

### Phase 3: 設定修正

1. 正しいシート名を設定ファイルに反映
2. 既存のコードを修正
3. 動作確認

## 成功基準

- スプレッドシート内の全シート名が取得できること
- 正しいシート名が特定できること
- スプレッドシート同期機能が正常に動作すること
