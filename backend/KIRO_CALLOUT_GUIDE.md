# Kiroへの呼びかけガイド - コメントデータ同期問題

**作成日**: 2026年1月28日  
**目的**: コメントデータが同期できない場合の効果的な呼びかけ方

---

## 🎯 基本の呼びかけ（推奨）

### パターン1: 最もシンプル（推奨）

```
【物件番号】のコメントが同期されていない。
スプシにはデータがある。
COMMENT_SYNC_FAILURE_PREVENTION.mdを参照して対応して。
```

**例**:
```
AA13453のコメントが同期されていない。
スプシにはデータがある。
COMMENT_SYNC_FAILURE_PREVENTION.mdを参照して対応して。
```

---

### パターン2: 複数物件の場合

```
以下の物件のコメントが同期されていない。
スプシにはデータがある。
COMMENT_SYNC_FAILURE_PREVENTION.mdを参照して一括同期して。

物件番号:
- AA13453
- AA12398
- CC100
```

---

### パターン3: 緊急対応が必要な場合

```
【物件番号】のコメントが同期されていない。緊急対応が必要。
手動同期エンドポイントを実行して。
```

**例**:
```
AA13453のコメントが同期されていない。緊急対応が必要。
手動同期エンドポイントを実行して。
```

---

## 📋 状況別の呼びかけ

### 状況1: 新規物件のコメントが表示されない

```
【物件番号】が公開物件サイトに表示されているが、コメントが表示されない。
スプシにはデータがある。
COMMENT_SYNC_FAILURE_PREVENTION.mdを参照して対応して。
```

---

### 状況2: 既存物件のコメントが突然消えた

```
【物件番号】のコメントが突然表示されなくなった。
以前は表示されていた。
COMMENT_SYNC_FAILURE_PREVENTION.mdを参照して対応して。
```

---

### 状況3: 複数物件で同じ問題が発生

```
複数の物件でコメントが同期されていない。
監視スクリプトを実行して、一括同期して。
COMMENT_SYNC_FAILURE_PREVENTION.mdを参照。
```

---

### 状況4: 同期エラーが頻発している

```
コメントデータの同期エラーが頻発している。
COMMENT_SYNC_FAILURE_PREVENTION.mdのトラブルシューティングを実行して。
```

---

## 🚀 Kiroが実行すること

### ステップ1: 問題の確認

Kiroは以下を確認します：

1. **スプレッドシートにデータが存在するか**
   ```bash
   npx ts-node backend/get-【物件番号】-comments.ts
   ```

2. **データベースの状態**
   ```sql
   SELECT property_number, favorite_comment, recommended_comments, property_about
   FROM property_details
   WHERE property_number = '【物件番号】';
   ```

3. **業務リストに物件が存在するか**
   ```bash
   npx ts-node backend/check-【物件番号】-in-gyomu-list.ts
   ```

---

### ステップ2: 手動同期の実行

#### 単一物件の場合

```bash
curl -X POST http://localhost:3000/api/admin/sync-comments/【物件番号】
```

#### 複数物件の場合

```bash
curl -X POST http://localhost:3000/api/admin/sync-comments-batch \
  -H "Content-Type: application/json" \
  -d '{"propertyNumbers": ["AA13453", "AA12398", "CC100"]}'
```

---

### ステップ3: 結果の確認

```bash
# データベースの状態を再確認
npx ts-node backend/check-【物件番号】-simple.ts
```

---

## ⚡ クイックリファレンス

### 最短の呼びかけ（コピペ用）

```
【物件番号】のコメント同期失敗。
COMMENT_SYNC_FAILURE_PREVENTION.md参照。
```

---

### 一括同期が必要な場合（コピペ用）

```
複数物件のコメント同期失敗。
監視スクリプト実行 → 一括同期。
COMMENT_SYNC_FAILURE_PREVENTION.md参照。
```

---

### 緊急対応が必要な場合（コピペ用）

```
【物件番号】のコメント同期失敗。緊急。
手動同期エンドポイント実行。
```

---

## 📞 重要なポイント

### ✅ 必ず伝えること

1. **物件番号** - 例: AA13453
2. **スプレッドシートにデータがあること** - 「スプシにはデータがある」
3. **参照ドキュメント** - `COMMENT_SYNC_FAILURE_PREVENTION.md`

### ❌ 伝えなくてもよいこと

- 詳細なエラーメッセージ（Kiroが調査します）
- 技術的な詳細（Kiroが確認します）
- 過去の経緯（ドキュメントに記録されています）

---

## 🎯 実例

### 実例1: シンプルな呼びかけ

**ユーザー**:
```
AA13453のコメントが同期されていない。
スプシにはデータがある。
COMMENT_SYNC_FAILURE_PREVENTION.mdを参照して対応して。
```

**Kiroの対応**:
1. ドキュメントを確認
2. スプレッドシートのデータを確認
3. データベースの状態を確認
4. 手動同期エンドポイントを実行
5. 結果を報告

---

### 実例2: 複数物件の呼びかけ

**ユーザー**:
```
以下の物件のコメントが同期されていない。
スプシにはデータがある。
COMMENT_SYNC_FAILURE_PREVENTION.mdを参照して一括同期して。

物件番号:
- AA13453
- AA12398
- CC100
```

**Kiroの対応**:
1. ドキュメントを確認
2. 監視スクリプトを実行
3. 一括同期エンドポイントを実行
4. 各物件の結果を報告

---

### 実例3: 緊急対応の呼びかけ

**ユーザー**:
```
AA13453のコメントが同期されていない。緊急対応が必要。
手動同期エンドポイントを実行して。
```

**Kiroの対応**:
1. 即座に手動同期エンドポイントを実行
2. 結果を報告
3. 必要に応じて追加調査

---

## 📚 関連ドキュメント

Kiroが参照するドキュメント：

1. **`COMMENT_SYNC_FAILURE_PREVENTION.md`** - 防止策の詳細
2. **`COMMENT_DATA_SOURCE_COMPLETE_GUIDE.md`** - データ取得元の定義
3. **`COMMENT_SYNC_PREVENTION_README.md`** - 使用方法ガイド

---

## 🔄 今後の改善

このガイドは、実際の使用状況に応じて更新されます。

**フィードバック歓迎**:
- より簡潔な呼びかけ方
- よくある状況の追加
- 効果的な表現の改善

---

**最終更新日**: 2026年1月28日  
**ステータス**: ✅ 完成
