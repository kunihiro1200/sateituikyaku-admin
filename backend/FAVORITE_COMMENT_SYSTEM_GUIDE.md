# ãŠæ°—ã«å…¥ã‚Šæ–‡è¨€ã‚·ã‚¹ãƒ†ãƒ  - å®Œå…¨ã‚¬ã‚¤ãƒ‰

## ğŸ“‹ ç›®æ¬¡
1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
3. [é‡è¦ãªä¿®æ­£å±¥æ­´](#é‡è¦ãªä¿®æ­£å±¥æ­´)
4. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
5. [è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰](#è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰)
6. [ãƒ‡ãƒ¼ã‚¿å¾©æ—§æ‰‹é †](#ãƒ‡ãƒ¼ã‚¿å¾©æ—§æ‰‹é †)

---

## ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### ãŠæ°—ã«å…¥ã‚Šæ–‡è¨€ã¨ã¯
å…¬é–‹ç‰©ä»¶ã‚µã‚¤ãƒˆã®ç‰©ä»¶è©³ç´°ãƒšãƒ¼ã‚¸ã§ã€ç”»åƒä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹ç‰©ä»¶ã®é­…åŠ›ã‚’ä¼ãˆã‚‹çŸ­æ–‡ã€‚

### ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜å ´æ‰€
- **ãƒ†ãƒ¼ãƒ–ãƒ«**: `property_details`
- **ã‚«ãƒ©ãƒ **: `favorite_comment` (TEXTå‹)
- **é–¢é€£ã‚«ãƒ©ãƒ **: `property_about`, `recommended_comments`, `athome_data`

### ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹
1. **å„ªå…ˆ**: æ¥­å‹™ãƒªã‚¹ãƒˆï¼ˆæ¥­å‹™ä¾é ¼ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆï¼‰ã®ã€Œã‚¹ãƒ—ã‚·URLã€åˆ—
2. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: æ¥­å‹™ä¾é ¼Driveãƒ•ã‚©ãƒ«ãƒ€å†…ã®ç‰©ä»¶ç•ªå·ã‚’å«ã‚€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ

### å–å¾—æ–¹æ³•
å€‹åˆ¥ç‰©ä»¶ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®`athome`ã‚·ãƒ¼ãƒˆã‹ã‚‰ç‰©ä»¶ã‚¿ã‚¤ãƒ—åˆ¥ã®ã‚»ãƒ«ã‚’å–å¾—ï¼š
- **åœŸåœ°**: B53
- **æˆ¸å»ºã¦**: B142
- **ãƒãƒ³ã‚·ãƒ§ãƒ³**: B150

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å…¬é–‹ç‰©ä»¶ã‚µã‚¤ãƒˆã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰©ä»¶è©³ç´°ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤º           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. PropertyListingService.getPublicPropertyById()           â”‚
â”‚    - property_listingsãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ç‰©ä»¶æƒ…å ±ã‚’å–å¾—            â”‚
â”‚    - property_detailsãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰favorite_commentã‚’å–å¾—     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. favorite_commentãŒnullã®å ´åˆ                             â”‚
â”‚    â†’ FavoriteCommentService.getFavoriteComment()ã‚’å‘¼ã³å‡ºã—  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. GyomuListService: æ¥­å‹™ãƒªã‚¹ãƒˆã‹ã‚‰ã€Œã‚¹ãƒ—ã‚·URLã€ã‚’æ¤œç´¢      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. GyomuDriveFolderService: Driveãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰æ¤œç´¢           â”‚
â”‚    - ãƒ•ã‚©ãƒ«ãƒ€ID: 1d9oHRSQ1_UAC5XakBLijUsendj0ZxD4F           â”‚
â”‚    - ç‰©ä»¶ç•ªå·ã‚’å«ã‚€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æ¤œç´¢                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. GoogleSheetsClient: athomeã‚·ãƒ¼ãƒˆã‹ã‚‰æ–‡è¨€ã‚’å–å¾—           â”‚
â”‚    - ç‰©ä»¶ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸã‚»ãƒ«ä½ç½®ã‹ã‚‰å–å¾—                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜ï¼ˆ5åˆ†é–“ï¼‰                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é‡è¦ãªä¿®æ­£å±¥æ­´

### ğŸ› ãƒã‚°1: ãƒ‡ãƒ¼ã‚¿å‰Šé™¤å•é¡Œï¼ˆ2026-01-14 03:10-03:11ï¼‰

#### å•é¡Œ
`PropertyDetailsService.upsertPropertyDetails()`ãŒéƒ¨åˆ†æ›´æ–°æ™‚ã«**å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’nullã§ä¸Šæ›¸ã**ã—ã¦ã„ãŸã€‚

#### åŸå› 
```typescript
// âŒ é–“é•ã£ãŸå®Ÿè£…
async upsertPropertyDetails(propertyNumber: string, details: Partial<PropertyDetails>) {
  await supabase
    .from('property_details')
    .upsert({
      property_number: propertyNumber,
      recommended_comments: details.recommended_comments || null,  // â† nullã§ä¸Šæ›¸ãï¼
      athome_data: details.athome_data || null,                    // â† nullã§ä¸Šæ›¸ãï¼
      favorite_comment: details.favorite_comment || null,          // â† nullã§ä¸Šæ›¸ãï¼
      property_about: details.property_about || null,              // â† nullã§ä¸Šæ›¸ãï¼
    });
}
```

#### ä¿®æ­£å†…å®¹
```typescript
// âœ… æ­£ã—ã„å®Ÿè£…
async upsertPropertyDetails(propertyNumber: string, details: Partial<PropertyDetails>) {
  // æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const existing = await this.getByPropertyNumber(propertyNumber);
  
  // æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨ãƒãƒ¼ã‚¸ï¼ˆæä¾›ã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿æ›´æ–°ï¼‰
  const merged = {
    property_number: propertyNumber,
    recommended_comments: details.recommended_comments ?? existing?.recommended_comments ?? null,
    athome_data: details.athome_data ?? existing?.athome_data ?? null,
    favorite_comment: details.favorite_comment ?? existing?.favorite_comment ?? null,
    property_about: details.property_about ?? existing?.property_about ?? null,
  };
  
  await supabase.from('property_details').upsert(merged);
}
```

#### å½±éŸ¿ã‚’å—ã‘ãŸãƒ•ã‚¡ã‚¤ãƒ«
- `backend/src/services/PropertyDetailsService.ts` âœ… ä¿®æ­£æ¸ˆã¿
- `backend/src/scripts/populatePropertyDetails.ts` âœ… ä¿®æ­£æ¸ˆã¿

---

### ğŸ› ãƒã‚°2: property_numberæ¤œç´¢å•é¡Œ

#### å•é¡Œ
`PropertyListingService.getPublicPropertyById()`ãŒUUIDã®ã¿å—ã‘ä»˜ã‘ã¦ã„ãŸãŒã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯`property_number`ã‚’æ¸¡ã—ã¦ã„ãŸã€‚

#### ä¿®æ­£å†…å®¹
```typescript
// âœ… UUIDã¨property_numberã®ä¸¡æ–¹ã«å¯¾å¿œ
async getPublicPropertyById(identifier: string): Promise<any> {
  // UUIDã‹property_numberã‹ã‚’åˆ¤å®š
  const isUUID = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(identifier);
  
  const query = supabase
    .from('property_listings')
    .select('*, property_details(*)')
    .in('atbb_status', PUBLIC_ATBB_STATUSES);
  
  if (isUUID) {
    query.eq('id', identifier);
  } else {
    query.eq('property_number', identifier);
  }
  
  const { data } = await query.single();
  return data;
}
```

#### å½±éŸ¿ã‚’å—ã‘ãŸãƒ•ã‚¡ã‚¤ãƒ«
- `backend/src/services/PropertyListingService.ts` âœ… ä¿®æ­£æ¸ˆã¿

---

### âœ¨ æ©Ÿèƒ½è¿½åŠ : Driveãƒ•ã‚©ãƒ«ãƒ€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

#### æ¦‚è¦
æ¥­å‹™ãƒªã‚¹ãƒˆã«ãªã„ç‰©ä»¶ã§ã‚‚ã€æ¥­å‹™ä¾é ¼Driveãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ç‰©ä»¶ç•ªå·ã‚’å«ã‚€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’è‡ªå‹•æ¤œç´¢ã€‚

#### å®Ÿè£…
- `backend/src/services/GyomuDriveFolderService.ts` ï¼ˆæ—¢å­˜ï¼‰
- `backend/src/services/FavoriteCommentService.ts` âœ… æ›´æ–°æ¸ˆã¿

#### æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯
1. æ¥­å‹™ãƒªã‚¹ãƒˆã®ã€Œã‚¹ãƒ—ã‚·URLã€åˆ—ã‚’æ¤œç´¢
2. è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ â†’ Driveãƒ•ã‚©ãƒ«ãƒ€å†…ã‚’æ¤œç´¢
   - ãƒ•ã‚©ãƒ«ãƒ€ID: `1d9oHRSQ1_UAC5XakBLijUsendj0ZxD4F`
   - ã‚¯ã‚¨ãƒª: `name contains 'ç‰©ä»¶ç•ªå·' and mimeType='application/vnd.google-apps.spreadsheet'`
3. è¤‡æ•°è¦‹ã¤ã‹ã£ãŸå ´åˆ â†’ ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã§æœ€é©ãªãƒãƒƒãƒã‚’é¸æŠ

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ç—‡çŠ¶1: ãŠæ°—ã«å…¥ã‚Šæ–‡è¨€ãŒè¡¨ç¤ºã•ã‚Œãªã„

#### è¨ºæ–­æ‰‹é †
```bash
# 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’ç¢ºèª
cd backend
node check-db-property-details-status.ts

# 2. ç‰¹å®šã®ç‰©ä»¶ã‚’ç¢ºèª
node check-property-details-favorite-comment.ts
```

#### ç¢ºèªãƒã‚¤ãƒ³ãƒˆ
1. **property_detailsãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã‹ï¼Ÿ**
   - ã‚ã‚‹ â†’ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã‚’ç¢ºèª
   - ãªã„ â†’ åŒæœŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ

2. **æ¥­å‹™ãƒªã‚¹ãƒˆã«ç‰©ä»¶ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ**
   ```bash
   node check-gyomu-list-coverage.ts
   ```

3. **Driveãƒ•ã‚©ãƒ«ãƒ€ã«ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹ã‹ï¼Ÿ**
   ```bash
   node test-drive-folder-search.ts
   ```

---

### ç—‡çŠ¶2: ãƒ‡ãƒ¼ã‚¿ãŒçªç„¶æ¶ˆãˆãŸ

#### åŸå› ã®ç‰¹å®š
```bash
# æœ€è¿‘ã®æ›´æ–°ã‚’ç¢ºèª
node investigate-favorite-comment-deletion.ts
```

#### ã‚ˆãã‚ã‚‹åŸå› 
1. **`PropertyDetailsService.upsertPropertyDetails()`ã®èª¤ç”¨**
   - éƒ¨åˆ†æ›´æ–°æ™‚ã«nullã‚’æ¸¡ã—ã¦ã„ãªã„ã‹ç¢ºèª
   - ä¿®æ­£æ¸ˆã¿ã ãŒã€ä»–ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§åŒæ§˜ã®å•é¡ŒãŒãªã„ã‹ç¢ºèª

2. **`populatePropertyDetails.ts`ã®å®Ÿè¡Œ**
   - ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ›´æ–°ã™ã‚‹
   - å®Ÿè¡Œå‰ã«å¿…ãšãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã‚‹

#### ãƒ‡ãƒ¼ã‚¿å¾©æ—§æ‰‹é †
```bash
# 1. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©æ—§ï¼ˆæ¨å¥¨ï¼‰
# Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ç¢ºèª

# 2. å†åŒæœŸ
node sync-favorite-comments-to-database.ts --force --property-number AA12345
```

---

### ç—‡çŠ¶3: Google Sheets APIã‚¯ã‚©ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼

#### ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
```
Quota exceeded for quota metric 'Read requests' and limit 'Read requests per minute per user'
```

#### å¯¾ç­–
1. **å¾…æ©Ÿ**: 1åˆ†é–“å¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œ
2. **ãƒãƒƒãƒå‡¦ç†**: è‡ªå‹•åŒæœŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯10åˆ†é–“éš”ã§å®Ÿè¡Œ
3. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨**: 
   - GyomuListService: 5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
   - GyomuDriveFolderService: 30åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥

---

## è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰

### åŸºæœ¬è¨ºæ–­
```bash
cd backend

# å…¨ä½“ã®çŠ¶æ…‹ã‚’ç¢ºèª
node check-db-property-details-status.ts

# ç‰¹å®šã®ç‰©ä»¶ã‚’ç¢ºèª
node check-property-details-favorite-comment.ts

# æ¥­å‹™ãƒªã‚¹ãƒˆã®ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ç¢ºèª
node check-gyomu-list-coverage.ts
```

### è©³ç´°è¨ºæ–­
```bash
# ãŠæ°—ã«å…¥ã‚Šæ–‡è¨€ã®å•é¡Œã‚’è¨ºæ–­
node diagnose-favorite-comment-issue.ts

# è¡¨ç¤ºå•é¡Œã‚’è¨ºæ–­
node diagnose-favorite-comment-display-issue.ts

# Driveãƒ•ã‚©ãƒ«ãƒ€æ¤œç´¢ã‚’ãƒ†ã‚¹ãƒˆ
node test-drive-folder-search.ts

# ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ
node test-favorite-comment-with-drive-fallback.ts
```

### åŒæœŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```bash
# æ‰‹å‹•åŒæœŸï¼ˆ1ä»¶ï¼‰
node sync-favorite-comments-to-database.ts --property-number AA12345

# æ‰‹å‹•åŒæœŸï¼ˆãƒãƒƒãƒï¼‰
node sync-favorite-comments-to-database.ts --limit 20 --offset 0

# å¼·åˆ¶ä¸Šæ›¸ã
node sync-favorite-comments-to-database.ts --force --property-number AA12345

# ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼ˆå®Ÿéš›ã«ã¯ä¿å­˜ã—ãªã„ï¼‰
node sync-favorite-comments-to-database.ts --dry-run --limit 10

# è‡ªå‹•ãƒãƒƒãƒåŒæœŸï¼ˆ10åˆ†é–“éš”ï¼‰
node auto-sync-all-favorite-comments.ts
```

---

## ãƒ‡ãƒ¼ã‚¿å¾©æ—§æ‰‹é †

### ã‚±ãƒ¼ã‚¹1: ç‰¹å®šã®ç‰©ä»¶ã®ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆãŸ

```bash
# 1. ç¾åœ¨ã®çŠ¶æ…‹ã‚’ç¢ºèª
node check-property-details-favorite-comment.ts

# 2. å†åŒæœŸï¼ˆå¼·åˆ¶ä¸Šæ›¸ãï¼‰
node sync-favorite-comments-to-database.ts --force --property-number AA12345

# 3. ç¢ºèª
node check-property-details-favorite-comment.ts
```

### ã‚±ãƒ¼ã‚¹2: è¤‡æ•°ã®ç‰©ä»¶ã®ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆãŸ

```bash
# 1. å½±éŸ¿ç¯„å›²ã‚’ç¢ºèª
node check-db-property-details-status.ts

# 2. ãƒãƒƒãƒå†åŒæœŸ
node sync-favorite-comments-to-database.ts --force --limit 100 --offset 0

# 3. ç¢ºèª
node check-db-property-details-status.ts
```

### ã‚±ãƒ¼ã‚¹3: å…¨ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆãŸ

```bash
# 1. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ç¢ºèª
# https://supabase.com/dashboard/project/krxhrbtlgfjzsseegaqq

# 2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©æ—§ï¼ˆæ¨å¥¨ï¼‰

# 3. ã¾ãŸã¯å…¨ä»¶å†åŒæœŸ
node auto-sync-all-favorite-comments.ts
```

---

## ç¾åœ¨ã®çŠ¶æ…‹ï¼ˆ2026-01-16ï¼‰

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±è¨ˆ
- **ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°**: 1,291ä»¶
- **favorite_commentä¿å­˜æ¸ˆã¿**: 10ä»¶ (1%)
- **property_aboutä¿å­˜æ¸ˆã¿**: 109ä»¶ (8%)
- **recommended_commentsä¿å­˜æ¸ˆã¿**: 19ä»¶ (1%)
- **athome_dataä¿å­˜æ¸ˆã¿**: 16ä»¶ (1%)

### è‡ªå‹•åŒæœŸã®é€²æ—
- **å®Ÿè¡Œä¸­**: `auto-sync-all-favorite-comments.ts`
- **å®Œäº†ãƒãƒƒãƒ**: 15ãƒãƒƒãƒï¼ˆ300ä»¶å‡¦ç†ï¼‰
- **å¾…æ©Ÿä¸­**: ãƒãƒƒãƒ16ï¼ˆã‚ªãƒ•ã‚»ãƒƒãƒˆ300ï¼‰
- **ãƒãƒƒãƒã‚µã‚¤ã‚º**: 20ä»¶
- **å¾…æ©Ÿæ™‚é–“**: 10åˆ†é–“

### æ—¢çŸ¥ã®å•é¡Œ
- **Google Sheets APIã‚¯ã‚©ãƒ¼ã‚¿**: é »ç¹ã«åˆ¶é™ã«é”ã™ã‚‹
- **å¯¾ç­–**: 10åˆ†é–“éš”ã®ãƒãƒƒãƒå‡¦ç†ã§å¯¾å¿œä¸­

---

## é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

### ã‚µãƒ¼ãƒ“ã‚¹
- `backend/src/services/FavoriteCommentService.ts` - ãŠæ°—ã«å…¥ã‚Šæ–‡è¨€å–å¾—
- `backend/src/services/PropertyDetailsService.ts` - property_detailsæ“ä½œ
- `backend/src/services/PropertyListingService.ts` - ç‰©ä»¶æƒ…å ±å–å¾—
- `backend/src/services/GyomuListService.ts` - æ¥­å‹™ãƒªã‚¹ãƒˆæ¤œç´¢
- `backend/src/services/GyomuDriveFolderService.ts` - Driveãƒ•ã‚©ãƒ«ãƒ€æ¤œç´¢

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- `backend/sync-favorite-comments-to-database.ts` - æ‰‹å‹•åŒæœŸ
- `backend/auto-sync-all-favorite-comments.ts` - è‡ªå‹•ãƒãƒƒãƒåŒæœŸ
- `backend/check-db-property-details-status.ts` - çŠ¶æ…‹ç¢ºèª

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `backend/FAVORITE_COMMENT_SYSTEM_GUIDE.md` - ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
- `backend/DRIVE_FOLDER_FALLBACK_SUMMARY.md` - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã®è©³ç´°

---

## ã¾ã¨ã‚

### âœ… ä¿®æ­£æ¸ˆã¿
1. `PropertyDetailsService.upsertPropertyDetails()`ã®éƒ¨åˆ†æ›´æ–°ãƒã‚°
2. `PropertyListingService.getPublicPropertyById()`ã®property_numberå¯¾å¿œ
3. Driveãƒ•ã‚©ãƒ«ãƒ€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã®è¿½åŠ 

### ğŸ”„ é€²è¡Œä¸­
- å…¨å…¬é–‹ç‰©ä»¶ã®ãŠæ°—ã«å…¥ã‚Šæ–‡è¨€åŒæœŸï¼ˆè‡ªå‹•ãƒãƒƒãƒå‡¦ç†ï¼‰

### âš ï¸ æ³¨æ„äº‹é …
- `PropertyDetailsService.upsertPropertyDetails()`ã‚’ä½¿ç”¨ã™ã‚‹éš›ã¯ã€å¿…ãšæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ã“ã¨
- Google Sheets APIã‚¯ã‚©ãƒ¼ã‚¿ã«æ³¨æ„ï¼ˆ1åˆ†ã‚ãŸã‚Šã®èª­ã¿å–ã‚Šåˆ¶é™ï¼‰
- ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ã“ã®ã‚¬ã‚¤ãƒ‰ã®ã€Œãƒ‡ãƒ¼ã‚¿å¾©æ—§æ‰‹é †ã€ã‚’å‚ç…§

---

**æœ€çµ‚æ›´æ–°**: 2026-01-16  
**ä½œæˆè€…**: Kiro AI Assistant
